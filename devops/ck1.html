<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>CKA Exam Prep ‚Äî Complete Study Guide</title>
<link href="https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@400;500;600;700;800&family=JetBrains+Mono:wght@400;600&display=swap" rel="stylesheet">
<style>
:root {
  --bg: #f8f9fc;
  --white: #ffffff;
  --surface: #f1f4f9;
  --border: #e2e8f0;
  --border2: #cbd5e1;
  --text: #0f172a;
  --text2: #334155;
  --muted: #64748b;
  --muted2: #94a3b8;
  --blue: #2563eb;
  --blue-light: #eff6ff;
  --blue-border: #bfdbfe;
  --green: #059669;
  --green-light: #ecfdf5;
  --green-border: #a7f3d0;
  --yellow: #d97706;
  --yellow-light: #fffbeb;
  --yellow-border: #fde68a;
  --red: #dc2626;
  --red-light: #fef2f2;
  --red-border: #fecaca;
  --purple: #7c3aed;
  --purple-light: #f5f3ff;
  --purple-border: #ddd6fe;
  --indigo: #4f46e5;
  --shadow-sm: 0 1px 3px rgba(0,0,0,0.08), 0 1px 2px rgba(0,0,0,0.04);
  --shadow: 0 4px 12px rgba(0,0,0,0.08), 0 2px 4px rgba(0,0,0,0.04);
  --shadow-lg: 0 10px 30px rgba(0,0,0,0.1), 0 4px 8px rgba(0,0,0,0.05);
}

* { margin:0; padding:0; box-sizing:border-box; }
html { scroll-behavior: smooth; }

body {
  background: var(--bg);
  color: var(--text);
  font-family: 'Plus Jakarta Sans', sans-serif;
  font-size: 14px;
  line-height: 1.6;
}

/* ===== LAYOUT ===== */
.layout { display: flex; min-height: 100vh; }

/* ===== SIDEBAR ===== */
.sidebar {
  width: 256px;
  flex-shrink: 0;
  background: var(--white);
  border-right: 1px solid var(--border);
  position: sticky;
  top: 0;
  height: 100vh;
  overflow-y: auto;
  display: flex;
  flex-direction: column;
}

.sidebar-top {
  padding: 20px;
  border-bottom: 1px solid var(--border);
}

.logo-chip {
  display: inline-flex;
  align-items: center;
  gap: 6px;
  background: var(--blue);
  color: #fff;
  font-size: 10px;
  font-weight: 700;
  letter-spacing: 0.12em;
  padding: 4px 10px;
  border-radius: 20px;
  margin-bottom: 10px;
}

.logo-dot {
  width: 5px; height: 5px;
  background: rgba(255,255,255,0.8);
  border-radius: 50%;
  animation: pulse 1.8s infinite;
}

@keyframes pulse { 0%,100%{opacity:1} 50%{opacity:0.3} }

.sidebar-title {
  font-size: 18px;
  font-weight: 800;
  color: var(--text);
  line-height: 1.2;
}

.sidebar-sub {
  font-size: 11px;
  color: var(--muted);
  margin-top: 3px;
}

.progress-area {
  padding: 14px 20px;
  border-bottom: 1px solid var(--border);
}

.progress-top {
  display: flex;
  justify-content: space-between;
  font-size: 11px;
  color: var(--muted);
  font-weight: 600;
  margin-bottom: 6px;
  letter-spacing: 0.05em;
}

.prog-bar {
  height: 6px;
  background: var(--surface);
  border-radius: 10px;
  overflow: hidden;
}

.prog-fill {
  height: 100%;
  background: linear-gradient(90deg, var(--blue), var(--indigo));
  border-radius: 10px;
  transition: width 0.5s ease;
}

nav { padding: 12px 8px; flex: 1; }

.nav-group-label {
  font-size: 10px;
  font-weight: 700;
  letter-spacing: 0.1em;
  color: var(--muted2);
  text-transform: uppercase;
  padding: 8px 12px 4px;
}

.nav-item {
  display: flex;
  align-items: center;
  gap: 8px;
  padding: 8px 12px;
  border-radius: 8px;
  color: var(--muted);
  font-size: 13px;
  font-weight: 500;
  text-decoration: none;
  transition: all 0.15s;
  margin-bottom: 1px;
  cursor: pointer;
}

.nav-item:hover { background: var(--surface); color: var(--text2); }
.nav-item.active { background: var(--blue-light); color: var(--blue); font-weight: 600; }

.nav-icon { font-size: 15px; }
.nav-badge {
  margin-left: auto;
  font-size: 10px;
  background: var(--surface);
  color: var(--muted);
  padding: 1px 7px;
  border-radius: 10px;
  font-weight: 600;
}

.nav-item.active .nav-badge { background: #dbeafe; color: var(--blue); }

.sidebar-bottom {
  padding: 12px 20px;
  border-top: 1px solid var(--border);
}

.mock-btn {
  width: 100%;
  padding: 10px;
  background: var(--indigo);
  color: #fff;
  border: none;
  border-radius: 10px;
  font-family: 'Plus Jakarta Sans', sans-serif;
  font-size: 13px;
  font-weight: 700;
  cursor: pointer;
  transition: all 0.2s;
  display: flex;
  align-items: center;
  justify-content: center;
  gap: 8px;
}

.mock-btn:hover { background: #4338ca; transform: translateY(-1px); box-shadow: var(--shadow); }

/* ===== MAIN ===== */
.main { flex: 1; overflow-x: hidden; }

/* ===== PAGE HEADER ===== */
.page-header {
  background: var(--white);
  border-bottom: 1px solid var(--border);
  padding: 36px 48px 32px;
  position: relative;
  overflow: hidden;
}

.page-header::before {
  content: '';
  position: absolute;
  right: 0; top: 0; bottom: 0;
  width: 300px;
  background: linear-gradient(135deg, #eff6ff 0%, #f5f3ff 100%);
}

.page-header > * { position: relative; z-index: 1; }

.header-tag {
  display: inline-flex;
  align-items: center;
  gap: 6px;
  font-size: 11px;
  font-weight: 700;
  letter-spacing: 0.1em;
  color: var(--blue);
  text-transform: uppercase;
  background: var(--blue-light);
  border: 1px solid var(--blue-border);
  padding: 4px 12px;
  border-radius: 20px;
  margin-bottom: 14px;
}

.page-title {
  font-size: clamp(26px,3.5vw,40px);
  font-weight: 800;
  color: var(--text);
  line-height: 1.15;
  margin-bottom: 10px;
}

.page-title .accent { color: var(--blue); }

.page-desc {
  font-size: 14px;
  color: var(--muted);
  max-width: 580px;
  line-height: 1.7;
  margin-bottom: 24px;
}

.stats-row {
  display: flex;
  gap: 12px;
  flex-wrap: wrap;
}

.stat-chip {
  background: var(--white);
  border: 1px solid var(--border);
  border-radius: 10px;
  padding: 10px 16px;
  display: flex;
  flex-direction: column;
  box-shadow: var(--shadow-sm);
  min-width: 90px;
}

.stat-val {
  font-size: 20px;
  font-weight: 800;
  color: var(--blue);
  line-height: 1;
}

.stat-label {
  font-size: 10px;
  font-weight: 600;
  color: var(--muted);
  text-transform: uppercase;
  letter-spacing: 0.08em;
  margin-top: 3px;
}

/* ===== CONTENT ===== */
.content { padding: 32px 48px 80px; }

.section { margin-bottom: 52px; }

.section-hd {
  display: flex;
  align-items: center;
  gap: 10px;
  margin-bottom: 20px;
  padding-bottom: 14px;
  border-bottom: 2px solid var(--border);
}

.section-icon { font-size: 22px; }

.section-title {
  font-size: 20px;
  font-weight: 800;
  color: var(--text);
}

.section-weight {
  margin-left: auto;
  font-size: 11px;
  font-weight: 700;
  background: var(--indigo);
  color: #fff;
  padding: 3px 12px;
  border-radius: 20px;
  letter-spacing: 0.05em;
}

/* ===== ALERTS ===== */
.alert {
  border-radius: 10px;
  padding: 12px 16px;
  display: flex;
  gap: 10px;
  font-size: 13px;
  line-height: 1.6;
  margin: 12px 0;
}

.alert-icon { flex-shrink: 0; font-size: 16px; margin-top: 1px; }

.alert-tip { background: var(--green-light); border: 1px solid var(--green-border); color: #065f46; }
.alert-warn { background: var(--yellow-light); border: 1px solid var(--yellow-border); color: #92400e; }
.alert-danger { background: var(--red-light); border: 1px solid var(--red-border); color: #991b1b; }
.alert-info { background: var(--blue-light); border: 1px solid var(--blue-border); color: #1e40af; }

/* ===== DOMAIN CARDS ===== */
.domain-grid {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
  gap: 14px;
  margin-bottom: 20px;
}

.domain-card {
  background: var(--white);
  border: 1px solid var(--border);
  border-radius: 12px;
  padding: 20px;
  box-shadow: var(--shadow-sm);
  transition: all 0.2s;
  position: relative;
  overflow: hidden;
}

.domain-card::after {
  content: '';
  position: absolute;
  top: 0; left: 0;
  width: 4px; height: 100%;
  border-radius: 12px 0 0 12px;
}

.domain-card.c1::after { background: var(--blue); }
.domain-card.c2::after { background: var(--green); }
.domain-card.c3::after { background: var(--indigo); }
.domain-card.c4::after { background: var(--yellow); }
.domain-card.c5::after { background: var(--red); }

.domain-card:hover { transform: translateY(-2px); box-shadow: var(--shadow); }

.dc-top {
  display: flex;
  justify-content: space-between;
  align-items: flex-start;
  margin-bottom: 12px;
  padding-left: 6px;
}

.dc-name {
  font-size: 13px;
  font-weight: 700;
  color: var(--text);
  line-height: 1.3;
}

.dc-pct {
  font-size: 28px;
  font-weight: 800;
  color: var(--blue);
  line-height: 1;
  flex-shrink: 0;
}

.dc-items {
  list-style: none;
  padding-left: 6px;
}

.dc-items li {
  font-size: 12px;
  color: var(--text2);
  padding: 4px 0;
  display: flex;
  gap: 8px;
  border-bottom: 1px solid var(--border);
  line-height: 1.4;
}

.dc-items li:last-child { border-bottom: none; }

.dc-items li::before {
  content: '‚Ä∫';
  color: var(--blue);
  font-weight: 700;
  flex-shrink: 0;
}

/* ===== COMPONENT CARDS ===== */
.comp-grid {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(290px, 1fr));
  gap: 12px;
}

.comp-card {
  background: var(--white);
  border: 1px solid var(--border);
  border-radius: 10px;
  overflow: hidden;
  box-shadow: var(--shadow-sm);
  cursor: pointer;
  transition: all 0.2s;
}

.comp-card:hover { box-shadow: var(--shadow); transform: translateY(-1px); }
.comp-card.open { border-color: var(--blue-border); box-shadow: 0 0 0 3px #dbeafe; }

.comp-head {
  display: flex;
  align-items: center;
  gap: 10px;
  padding: 14px 16px;
  background: var(--surface);
}

.comp-card.open .comp-head { background: var(--blue-light); }

.comp-emoji { font-size: 20px; }
.comp-info { flex: 1; min-width: 0; }
.comp-name { font-size: 13px; font-weight: 700; color: var(--text); }
.comp-type { font-size: 11px; color: var(--muted); margin-top: 1px; }
.comp-toggle { font-size: 11px; color: var(--muted); transition: transform 0.2s; flex-shrink: 0; }
.comp-card.open .comp-toggle { transform: rotate(90deg); }

.comp-body { display: none; padding: 16px; border-top: 1px solid var(--border); }
.comp-card.open .comp-body { display: block; }

.comp-desc { font-size: 12px; color: var(--text2); line-height: 1.7; margin-bottom: 12px; }

/* ===== CODE BLOCKS ===== */
.code-label {
  font-size: 10px;
  font-weight: 700;
  letter-spacing: 0.1em;
  color: var(--muted);
  text-transform: uppercase;
  margin-bottom: 5px;
  margin-top: 12px;
}

.code-label:first-child { margin-top: 0; }

.code-block {
  background: #1e293b;
  border-radius: 8px;
  padding: 14px 16px;
  font-family: 'JetBrains Mono', monospace;
  font-size: 12px;
  line-height: 1.65;
  overflow-x: auto;
  color: #e2e8f0;
}

.code-block .comment { color: #64748b; }
.code-block .key { color: #93c5fd; }
.code-block .val { color: #86efac; }
.code-block .cmd { color: #67e8f9; }
.code-block .flag { color: #c4b5fd; }
.code-block .str { color: #fda4af; }
.code-block .num { color: #fbbf24; }

/* ===== TABS ===== */
.tabs {
  display: flex;
  gap: 4px;
  flex-wrap: wrap;
  border-bottom: 2px solid var(--border);
  margin-bottom: 16px;
}

.tab {
  padding: 8px 16px;
  font-family: 'Plus Jakarta Sans', sans-serif;
  font-size: 12px;
  font-weight: 600;
  color: var(--muted);
  background: transparent;
  border: none;
  border-bottom: 2px solid transparent;
  margin-bottom: -2px;
  cursor: pointer;
  transition: all 0.15s;
  border-radius: 6px 6px 0 0;
}

.tab:hover { color: var(--text2); background: var(--surface); }
.tab.active { color: var(--blue); border-bottom-color: var(--blue); background: var(--blue-light); }

.tab-content { display: none; }
.tab-content.active { display: block; }

/* ===== TABLES ===== */
.cmd-table {
  width: 100%;
  border-collapse: collapse;
  font-size: 12px;
  background: var(--white);
  border-radius: 10px;
  overflow: hidden;
  box-shadow: var(--shadow-sm);
  border: 1px solid var(--border);
}

.cmd-table th {
  background: var(--surface);
  padding: 10px 14px;
  text-align: left;
  font-size: 11px;
  font-weight: 700;
  color: var(--muted);
  letter-spacing: 0.06em;
  text-transform: uppercase;
  border-bottom: 1px solid var(--border);
}

.cmd-table td {
  padding: 9px 14px;
  border-bottom: 1px solid var(--border);
  vertical-align: top;
  color: var(--text2);
}

.cmd-table tr:last-child td { border-bottom: none; }
.cmd-table tr:hover td { background: var(--blue-light); }

.cmd-table td:first-child {
  font-family: 'JetBrains Mono', monospace;
  font-size: 11px;
  color: var(--blue);
  font-weight: 600;
}

/* ===== CONCEPT GRID ===== */
.concept-grid {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(240px, 1fr));
  gap: 12px;
}

.concept-card {
  background: var(--white);
  border: 1px solid var(--border);
  border-radius: 10px;
  padding: 16px;
  box-shadow: var(--shadow-sm);
  transition: all 0.2s;
}

.concept-card:hover { transform: translateY(-2px); box-shadow: var(--shadow); }

.cc-icon { font-size: 24px; margin-bottom: 8px; }
.cc-title { font-size: 14px; font-weight: 700; color: var(--text); margin-bottom: 6px; }
.cc-body { font-size: 12px; color: var(--text2); line-height: 1.65; }

.cc-tag {
  display: inline-block;
  font-size: 10px;
  font-weight: 700;
  padding: 2px 9px;
  border-radius: 20px;
  margin-top: 8px;
  letter-spacing: 0.06em;
}

.tag-blue { background: var(--blue-light); color: var(--blue); border: 1px solid var(--blue-border); }
.tag-green { background: var(--green-light); color: var(--green); border: 1px solid var(--green-border); }
.tag-yellow { background: var(--yellow-light); color: var(--yellow); border: 1px solid var(--yellow-border); }
.tag-purple { background: var(--purple-light); color: var(--purple); border: 1px solid var(--purple-border); }
.tag-red { background: var(--red-light); color: var(--red); border: 1px solid var(--red-border); }

/* ===== FLOW ===== */
.flow-wrap { overflow-x: auto; padding: 4px 0 12px; }

.flow {
  display: flex;
  align-items: center;
  gap: 0;
  min-width: max-content;
}

.flow-node {
  background: var(--white);
  border: 1.5px solid var(--border);
  border-radius: 10px;
  padding: 12px 14px;
  text-align: center;
  min-width: 110px;
  box-shadow: var(--shadow-sm);
  transition: all 0.2s;
}

.flow-node:hover { border-color: var(--blue-border); box-shadow: var(--shadow); transform: translateY(-2px); }

.fn-icon { font-size: 20px; margin-bottom: 4px; }
.fn-name { font-size: 11px; font-weight: 700; color: var(--text); }
.fn-sub { font-size: 10px; color: var(--muted); margin-top: 2px; }

.flow-arr {
  padding: 0 8px;
  color: var(--blue);
  font-size: 18px;
  font-weight: 700;
}

/* ===== TWO COL ===== */
.two-col {
  display: grid;
  grid-template-columns: 1fr 1fr;
  gap: 20px;
}

@media (max-width: 900px) {
  .two-col { grid-template-columns: 1fr; }
  .sidebar { display: none; }
  .content { padding: 24px 20px 60px; }
  .page-header { padding: 24px 20px; }
}

/* ===== CHECKLIST ===== */
.checklist { list-style: none; display: flex; flex-direction: column; gap: 4px; }

.checklist li {
  display: flex;
  align-items: center;
  gap: 10px;
  font-size: 12px;
  color: var(--text2);
  padding: 8px 12px;
  border-radius: 8px;
  cursor: pointer;
  border: 1px solid transparent;
  background: var(--white);
  box-shadow: var(--shadow-sm);
  transition: all 0.15s;
}

.checklist li:hover { border-color: var(--blue-border); }
.checklist li.checked { background: var(--green-light); border-color: var(--green-border); color: #065f46; }

.chk-box {
  width: 18px; height: 18px;
  border: 1.5px solid var(--border2);
  border-radius: 5px;
  display: flex;
  align-items: center;
  justify-content: center;
  font-size: 11px;
  flex-shrink: 0;
  transition: all 0.15s;
  color: transparent;
}

.checklist li.checked .chk-box {
  background: var(--green);
  border-color: var(--green);
  color: white;
}

hr { border: none; border-top: 1px solid var(--border); margin: 20px 0; }

/* ===== MOCK EXAM MODAL ===== */
.mock-overlay {
  display: none;
  position: fixed;
  inset: 0;
  background: rgba(15,23,42,0.7);
  backdrop-filter: blur(4px);
  z-index: 1000;
  overflow-y: auto;
  padding: 20px;
}

.mock-overlay.active { display: flex; align-items: flex-start; justify-content: center; }

.mock-modal {
  background: var(--white);
  border-radius: 16px;
  width: 100%;
  max-width: 860px;
  box-shadow: var(--shadow-lg);
  overflow: hidden;
  margin: auto;
}

/* ===== MOCK HEADER ===== */
.mock-header {
  background: var(--indigo);
  padding: 20px 28px;
  display: flex;
  align-items: center;
  gap: 16px;
  color: #fff;
}

.mock-header-info { flex: 1; }
.mock-header h2 { font-size: 20px; font-weight: 800; }
.mock-header p { font-size: 12px; opacity: 0.8; margin-top: 2px; }

.mock-timer {
  background: rgba(255,255,255,0.15);
  border: 1px solid rgba(255,255,255,0.25);
  border-radius: 10px;
  padding: 10px 18px;
  text-align: center;
  min-width: 90px;
}

.timer-val {
  font-family: 'JetBrains Mono', monospace;
  font-size: 24px;
  font-weight: 700;
  display: block;
  line-height: 1;
}

.timer-label { font-size: 10px; opacity: 0.7; margin-top: 3px; }

.mock-close {
  background: rgba(255,255,255,0.1);
  border: 1px solid rgba(255,255,255,0.2);
  color: #fff;
  width: 32px; height: 32px;
  border-radius: 8px;
  cursor: pointer;
  font-size: 18px;
  display: flex; align-items: center; justify-content: center;
  transition: background 0.15s;
  flex-shrink: 0;
}

.mock-close:hover { background: rgba(255,255,255,0.25); }

/* Mock progress bar */
.mock-prog-bar {
  height: 4px;
  background: #e2e8f0;
}

.mock-prog-fill {
  height: 100%;
  background: linear-gradient(90deg, #4f46e5, #7c3aed);
  transition: width 0.4s ease;
}

/* Question area */
.mock-body { padding: 28px; }

.q-meta {
  display: flex;
  align-items: center;
  gap: 10px;
  margin-bottom: 18px;
}

.q-num {
  font-size: 11px;
  font-weight: 700;
  color: var(--muted);
  background: var(--surface);
  padding: 3px 10px;
  border-radius: 20px;
}

.q-domain {
  font-size: 11px;
  font-weight: 700;
  padding: 3px 10px;
  border-radius: 20px;
}

.q-diff {
  margin-left: auto;
  font-size: 10px;
  font-weight: 700;
  padding: 3px 10px;
  border-radius: 20px;
}

.diff-easy { background: var(--green-light); color: var(--green); border: 1px solid var(--green-border); }
.diff-med { background: var(--yellow-light); color: var(--yellow); border: 1px solid var(--yellow-border); }
.diff-hard { background: var(--red-light); color: var(--red); border: 1px solid var(--red-border); }

.q-text {
  font-size: 15px;
  font-weight: 700;
  color: var(--text);
  line-height: 1.55;
  margin-bottom: 8px;
}

.q-scenario {
  font-size: 13px;
  color: var(--text2);
  background: var(--surface);
  border-left: 3px solid var(--blue);
  padding: 12px 14px;
  border-radius: 0 8px 8px 0;
  margin-bottom: 20px;
  line-height: 1.65;
}

.q-context-code {
  background: #1e293b;
  border-radius: 8px;
  padding: 12px 14px;
  font-family: 'JetBrains Mono', monospace;
  font-size: 12px;
  color: #93c5fd;
  margin: 8px 0 16px;
  overflow-x: auto;
}

/* Answer area */
.answer-area {
  border: 1.5px solid var(--border);
  border-radius: 10px;
  overflow: hidden;
  margin-bottom: 16px;
}

.answer-area textarea {
  width: 100%;
  min-height: 140px;
  padding: 14px 16px;
  font-family: 'JetBrains Mono', monospace;
  font-size: 12px;
  color: var(--text);
  background: var(--white);
  border: none;
  resize: vertical;
  outline: none;
  line-height: 1.65;
}

.answer-area textarea:focus { background: #fafbff; }

.answer-toolbar {
  display: flex;
  align-items: center;
  gap: 8px;
  padding: 8px 14px;
  background: var(--surface);
  border-top: 1px solid var(--border);
}

.answer-toolbar span {
  font-size: 11px;
  color: var(--muted);
}

/* MCQ options */
.mcq-options { display: flex; flex-direction: column; gap: 8px; margin-bottom: 16px; }

.mcq-option {
  display: flex;
  align-items: flex-start;
  gap: 12px;
  padding: 12px 16px;
  border: 1.5px solid var(--border);
  border-radius: 10px;
  cursor: pointer;
  transition: all 0.15s;
  background: var(--white);
}

.mcq-option:hover { border-color: var(--blue-border); background: var(--blue-light); }
.mcq-option.selected { border-color: var(--blue); background: var(--blue-light); }
.mcq-option.correct { border-color: var(--green); background: var(--green-light) !important; }
.mcq-option.wrong { border-color: var(--red); background: var(--red-light) !important; }

.mcq-letter {
  width: 26px; height: 26px;
  border: 1.5px solid var(--border2);
  border-radius: 6px;
  display: flex; align-items: center; justify-content: center;
  font-size: 12px;
  font-weight: 700;
  color: var(--muted);
  flex-shrink: 0;
  transition: all 0.15s;
}

.mcq-option.selected .mcq-letter { background: var(--blue); border-color: var(--blue); color: #fff; }
.mcq-option.correct .mcq-letter { background: var(--green); border-color: var(--green); color: #fff; }
.mcq-option.wrong .mcq-letter { background: var(--red); border-color: var(--red); color: #fff; }

.mcq-text { font-size: 13px; color: var(--text2); line-height: 1.5; }

/* Explanation */
.explanation {
  background: var(--yellow-light);
  border: 1px solid var(--yellow-border);
  border-radius: 10px;
  padding: 16px;
  font-size: 13px;
  color: #78350f;
  line-height: 1.65;
  display: none;
  margin-bottom: 16px;
}

.explanation.show { display: block; }

.exp-title {
  font-weight: 700;
  font-size: 12px;
  text-transform: uppercase;
  letter-spacing: 0.08em;
  margin-bottom: 6px;
  color: #92400e;
}

.exp-code {
  background: #1e293b;
  color: #93c5fd;
  border-radius: 6px;
  padding: 10px 12px;
  font-family: 'JetBrains Mono', monospace;
  font-size: 11px;
  margin-top: 8px;
  overflow-x: auto;
}

/* Mock footer */
.mock-footer {
  display: flex;
  align-items: center;
  gap: 10px;
  padding: 18px 28px;
  background: var(--surface);
  border-top: 1px solid var(--border);
}

.mock-footer-left { flex: 1; display: flex; gap: 8px; align-items: center; }

.mock-q-dots {
  display: flex;
  gap: 4px;
  flex-wrap: wrap;
  max-width: 300px;
}

.q-dot {
  width: 10px; height: 10px;
  border-radius: 50%;
  background: var(--border2);
  cursor: pointer;
  transition: all 0.15s;
}

.q-dot.current { background: var(--blue); transform: scale(1.3); }
.q-dot.answered { background: var(--green); }
.q-dot.skipped { background: var(--yellow); }

.btn {
  padding: 9px 20px;
  border-radius: 8px;
  font-family: 'Plus Jakarta Sans', sans-serif;
  font-size: 13px;
  font-weight: 700;
  cursor: pointer;
  border: none;
  transition: all 0.15s;
}

.btn-ghost { background: transparent; border: 1.5px solid var(--border2); color: var(--text2); }
.btn-ghost:hover { border-color: var(--blue); color: var(--blue); }

.btn-primary { background: var(--blue); color: #fff; }
.btn-primary:hover { background: #1d4ed8; transform: translateY(-1px); }

.btn-success { background: var(--green); color: #fff; }
.btn-success:hover { background: #047857; }

/* Results screen */
.results-screen {
  padding: 36px 28px;
  text-align: center;
  display: none;
}

.results-screen.show { display: block; }

.results-ring {
  width: 140px; height: 140px;
  border-radius: 50%;
  display: flex; flex-direction: column;
  align-items: center; justify-content: center;
  margin: 0 auto 24px;
  font-size: 36px;
  font-weight: 800;
}

.ring-pass { background: var(--green-light); border: 4px solid var(--green); color: var(--green); }
.ring-fail { background: var(--red-light); border: 4px solid var(--red); color: var(--red); }

.results-sub { font-size: 14px; color: var(--muted); margin-bottom: 24px; }

.results-breakdown {
  display: grid;
  grid-template-columns: repeat(3,1fr);
  gap: 12px;
  max-width: 400px;
  margin: 0 auto 24px;
}

.rb-item {
  background: var(--surface);
  border-radius: 10px;
  padding: 14px;
  border: 1px solid var(--border);
}

.rb-val { font-size: 24px; font-weight: 800; color: var(--text); }
.rb-label { font-size: 10px; color: var(--muted); margin-top: 3px; font-weight: 600; }

/* Scrollbar */
::-webkit-scrollbar { width: 6px; height: 6px; }
::-webkit-scrollbar-track { background: var(--surface); }
::-webkit-scrollbar-thumb { background: var(--border2); border-radius: 3px; }
::-webkit-scrollbar-thumb:hover { background: var(--muted2); }

.anchor { scroll-margin-top: 20px; }
</style>
</head>
<body>

<!-- ===== MOCK EXAM OVERLAY ===== -->
<div class="mock-overlay" id="mockOverlay">
  <div class="mock-modal" id="mockModal">
    <!-- Header -->
    <div class="mock-header">
      <div class="mock-header-info">
        <h2>üéØ CKA Mock Exam</h2>
        <p id="mockSubtitle">20 questions ¬∑ Covers all exam domains</p>
      </div>
      <div class="mock-timer">
        <span class="timer-val" id="timerVal">120:00</span>
        <div class="timer-label">remaining</div>
      </div>
      <button class="mock-close" onclick="closeMock()" title="Close">√ó</button>
    </div>
    <div class="mock-prog-bar"><div class="mock-prog-fill" id="mockProgFill" style="width:5%"></div></div>

    <!-- Question body -->
    <div id="questionScreen">
      <div class="mock-body" id="mockBody"><!-- Injected by JS --></div>
      <div class="mock-footer">
        <div class="mock-footer-left">
          <div class="mock-q-dots" id="qDots"></div>
        </div>
        <button class="btn btn-ghost" onclick="skipQuestion()">Skip ‚Üí</button>
        <button class="btn btn-ghost" id="hintBtn" onclick="showHint()">üí° Hint</button>
        <button class="btn btn-primary" id="submitBtn" onclick="submitAnswer()">Check Answer</button>
        <button class="btn btn-primary" id="nextBtn" onclick="nextQuestion()" style="display:none">Next ‚Üí</button>
      </div>
    </div>

    <!-- Results screen -->
    <div class="results-screen" id="resultsScreen">
      <div class="results-ring" id="resultsRing"></div>
      <h2 style="font-size:22px;font-weight:800;margin-bottom:6px" id="resultsTitle"></h2>
      <p class="results-sub" id="resultsDesc"></p>
      <div class="results-breakdown">
        <div class="rb-item"><div class="rb-val" id="rb-correct">0</div><div class="rb-label">Correct</div></div>
        <div class="rb-item"><div class="rb-val" id="rb-wrong">0</div><div class="rb-label">Wrong</div></div>
        <div class="rb-item"><div class="rb-val" id="rb-skip">0</div><div class="rb-label">Skipped</div></div>
      </div>
      <div style="display:flex;gap:10px;justify-content:center;flex-wrap:wrap">
        <button class="btn btn-ghost" onclick="closeMock()">‚Üê Back to Study</button>
        <button class="btn btn-primary" onclick="startMock()">Retake Exam</button>
      </div>
    </div>
  </div>
</div>

<!-- ===== LAYOUT ===== -->
<div class="layout">

<!-- SIDEBAR -->
<aside class="sidebar">
  <div class="sidebar-top">
    <div class="logo-chip"><span class="logo-dot"></span> K8s CKA PREP</div>
    <div class="sidebar-title">Kubernetes<br>Study Guide</div>
    <div class="sidebar-sub">Certified Kubernetes Administrator</div>
  </div>

  <div class="progress-area">
    <div class="progress-top">
      <span>STUDY PROGRESS</span>
      <span id="progressPct">0%</span>
    </div>
    <div class="prog-bar"><div class="prog-fill" id="progressFill" style="width:0%"></div></div>
  </div>

  <nav>
    <div class="nav-group-label">Overview</div>
    <a href="#overview" class="nav-item active"><span class="nav-icon">üìã</span> Exam Overview <span class="nav-badge">25%</span></a>
    <a href="#architecture" class="nav-item"><span class="nav-icon">üèóÔ∏è</span> Architecture <span class="nav-badge">25%</span></a>

    <div class="nav-group-label">Core Domains</div>
    <a href="#workloads" class="nav-item"><span class="nav-icon">‚öôÔ∏è</span> Workloads <span class="nav-badge">15%</span></a>
    <a href="#scheduling" class="nav-item"><span class="nav-icon">üìÖ</span> Scheduling</a>
    <a href="#networking" class="nav-item"><span class="nav-icon">üåê</span> Networking <span class="nav-badge">20%</span></a>
    <a href="#storage" class="nav-item"><span class="nav-icon">üíæ</span> Storage <span class="nav-badge">10%</span></a>
    <a href="#security" class="nav-item"><span class="nav-icon">üîê</span> Security <span class="nav-badge">12%</span></a>
    <a href="#troubleshoot" class="nav-item"><span class="nav-icon">üîß</span> Troubleshooting <span class="nav-badge">30%</span></a>

    <div class="nav-group-label">Reference</div>
    <a href="#kubectl" class="nav-item"><span class="nav-icon">‚å®Ô∏è</span> kubectl Cheatsheet</a>
    <a href="#yaml" class="nav-item"><span class="nav-icon">üìù</span> YAML Templates</a>
    <a href="#checklist" class="nav-item"><span class="nav-icon">‚úÖ</span> Exam Checklist</a>
  </nav>

  <div class="sidebar-bottom">
    <button class="mock-btn" onclick="startMock()">üéØ Start Mock Exam</button>
  </div>
</aside>

<!-- MAIN -->
<main class="main">

<div class="page-header">
  <div class="header-tag">üìö CKA Exam Preparation</div>
  <h1 class="page-title">Certified Kubernetes<br><span class="accent">Administrator</span> Guide</h1>
  <p class="page-desc">A complete, exam-focused study resource covering all CKA domains ‚Äî with interactive components, full YAML references, kubectl cheatsheet, and a timed mock exam.</p>
  <div class="stats-row">
    <div class="stat-chip"><div class="stat-val">2h</div><div class="stat-label">Duration</div></div>
    <div class="stat-chip"><div class="stat-val">66%</div><div class="stat-label">Pass Score</div></div>
    <div class="stat-chip"><div class="stat-val">15‚Äì20</div><div class="stat-label">Questions</div></div>
    <div class="stat-chip"><div class="stat-val">CLI</div><div class="stat-label">100% Hands-on</div></div>
    <div class="stat-chip"><div class="stat-val">1.30</div><div class="stat-label">K8s Version</div></div>
  </div>
</div>

<div class="content">

<!-- OVERVIEW -->
<section class="section anchor" id="overview">
  <div class="section-hd">
    <span class="section-icon">üìã</span>
    <h2 class="section-title">Exam Domain Weights</h2>
  </div>
  <div class="alert alert-tip"><span class="alert-icon">üí°</span><div>The CKA is <strong>100% performance-based</strong> ‚Äî you perform tasks on live Kubernetes clusters via a terminal. You have access to official Kubernetes docs (<strong>kubernetes.io/docs</strong>) during the exam.</div></div>
  <div class="domain-grid">
    <div class="domain-card c1">
      <div class="dc-top"><div class="dc-name">Cluster Architecture,<br>Installation &amp; Config</div><div class="dc-pct">25%</div></div>
      <ul class="dc-items">
        <li>Manage role-based access control (RBAC)</li>
        <li>Use Kubeadm to install a basic cluster</li>
        <li>Manage a highly-available K8s cluster</li>
        <li>Perform version upgrades (kubeadm upgrade)</li>
        <li>Implement etcd backup and restore</li>
      </ul>
    </div>
    <div class="domain-card c2">
      <div class="dc-top"><div class="dc-name">Workloads &amp; Scheduling</div><div class="dc-pct">15%</div></div>
      <ul class="dc-items">
        <li>Deployments, rolling updates, rollbacks</li>
        <li>ConfigMaps and Secrets in pods</li>
        <li>Resource limits and requests</li>
        <li>Jobs and CronJobs</li>
        <li>Multi-container pod patterns</li>
      </ul>
    </div>
    <div class="domain-card c3">
      <div class="dc-top"><div class="dc-name">Services &amp; Networking</div><div class="dc-pct">20%</div></div>
      <ul class="dc-items">
        <li>Pod connectivity and CNI plugins</li>
        <li>Service types: ClusterIP, NodePort, LB</li>
        <li>Ingress controllers and rules</li>
        <li>CoreDNS configuration</li>
        <li>Network Policies</li>
      </ul>
    </div>
    <div class="domain-card c4">
      <div class="dc-top"><div class="dc-name">Storage</div><div class="dc-pct">10%</div></div>
      <ul class="dc-items">
        <li>Storage classes and dynamic provisioning</li>
        <li>Access modes and reclaim policies</li>
        <li>PersistentVolumeClaims (PVCs)</li>
        <li>Configure apps with persistent storage</li>
      </ul>
    </div>
    <div class="domain-card c5">
      <div class="dc-top"><div class="dc-name">Troubleshooting</div><div class="dc-pct">30%</div></div>
      <ul class="dc-items">
        <li>Evaluate cluster and node logging</li>
        <li>Troubleshoot application failure</li>
        <li>Troubleshoot cluster component failure</li>
        <li>Troubleshoot networking issues</li>
        <li>Debug with crictl on nodes</li>
      </ul>
    </div>
  </div>
  <div class="alert alert-warn"><span class="alert-icon">‚ö†Ô∏è</span><div><strong>Troubleshooting is worth 30% ‚Äî the most heavily weighted domain.</strong> Practice debugging broken clusters, pods in CrashLoopBackOff, pending pods, and network policy issues until they feel instinctive.</div></div>
</section>

<!-- ARCHITECTURE -->
<section class="section anchor" id="architecture">
  <div class="section-hd">
    <span class="section-icon">üèóÔ∏è</span>
    <h2 class="section-title">Cluster Architecture ‚Äî Deep Dive</h2>
    <span class="section-weight">25% of exam</span>
  </div>

  <div class="flow-wrap">
    <div class="flow">
      <div class="flow-node"><div class="fn-icon">üë§</div><div class="fn-name">kubectl</div><div class="fn-sub">YAML manifest</div></div>
      <div class="flow-arr">‚Üí</div>
      <div class="flow-node"><div class="fn-icon">üîå</div><div class="fn-name">API Server</div><div class="fn-sub">Authn/Authz/Admit</div></div>
      <div class="flow-arr">‚Üí</div>
      <div class="flow-node"><div class="fn-icon">üóÑÔ∏è</div><div class="fn-name">etcd</div><div class="fn-sub">Desired state stored</div></div>
      <div class="flow-arr">‚Üí</div>
      <div class="flow-node"><div class="fn-icon">üîÑ</div><div class="fn-name">Controller</div><div class="fn-sub">Creates pod object</div></div>
      <div class="flow-arr">‚Üí</div>
      <div class="flow-node"><div class="fn-icon">üìÖ</div><div class="fn-name">Scheduler</div><div class="fn-sub">Binds to node</div></div>
      <div class="flow-arr">‚Üí</div>
      <div class="flow-node"><div class="fn-icon">ü§ñ</div><div class="fn-name">kubelet</div><div class="fn-sub">Pulls &amp; runs container</div></div>
      <div class="flow-arr">‚Üí</div>
      <div class="flow-node"><div class="fn-icon">üì¶</div><div class="fn-name">containerd</div><div class="fn-sub">runc ‚Üí namespace</div></div>
    </div>
  </div>

  <div class="comp-grid" style="margin-top:16px">
    <div class="comp-card" onclick="toggleComp(this)">
      <div class="comp-head"><span class="comp-emoji">üîå</span><div class="comp-info"><div class="comp-name">kube-apiserver</div><div class="comp-type">Control Plane ¬∑ Port 6443</div></div><span class="comp-toggle">‚ñ∂</span></div>
      <div class="comp-body">
        <div class="comp-desc">The only component that reads/writes etcd. All operations flow through it. Processes: Authentication ‚Üí Authorization (RBAC) ‚Üí Admission Controllers ‚Üí Persistence.</div>
        <div class="code-label">Key flags</div>
        <div class="code-block"><span class="comment"># Static pod: /etc/kubernetes/manifests/kube-apiserver.yaml</span>
<span class="key">--etcd-servers</span>=https://127.0.0.1:2379
<span class="key">--service-cluster-ip-range</span>=10.96.0.0/12
<span class="key">--enable-admission-plugins</span>=NodeRestriction
<span class="key">--authorization-mode</span>=Node,RBAC</div>
        <div class="alert alert-tip" style="margin-top:8px"><span class="alert-icon">üí°</span><div>If apiserver is down: check <code>/etc/kubernetes/manifests/kube-apiserver.yaml</code> and run <code>crictl ps</code> to verify it's running.</div></div>
      </div>
    </div>

    <div class="comp-card" onclick="toggleComp(this)">
      <div class="comp-head"><span class="comp-emoji">üóÑÔ∏è</span><div class="comp-info"><div class="comp-name">etcd</div><div class="comp-type">Control Plane ¬∑ Port 2379/2380</div></div><span class="comp-toggle">‚ñ∂</span></div>
      <div class="comp-body">
        <div class="comp-desc">Distributed key-value store (Raft consensus). Single source of truth. API Server is the ONLY component that talks to etcd directly.</div>
        <div class="code-label">Backup &amp; Restore ‚Äî HIGH EXAM FREQUENCY ‚ö°</div>
        <div class="code-block"><span class="comment"># Snapshot backup</span>
<span class="cmd">ETCDCTL_API=3</span> etcdctl snapshot save /opt/etcd-backup.db \
  <span class="flag">--endpoints</span>=https://127.0.0.1:2379 \
  <span class="flag">--cacert</span>=/etc/kubernetes/pki/etcd/ca.crt \
  <span class="flag">--cert</span>=/etc/kubernetes/pki/etcd/server.crt \
  <span class="flag">--key</span>=/etc/kubernetes/pki/etcd/server.key

<span class="comment"># Verify snapshot</span>
<span class="cmd">ETCDCTL_API=3</span> etcdctl snapshot status /opt/etcd-backup.db

<span class="comment"># Restore</span>
<span class="cmd">ETCDCTL_API=3</span> etcdctl snapshot restore /opt/etcd-backup.db \
  <span class="flag">--data-dir</span>=/var/lib/etcd-restored</div>
        <div class="alert alert-warn" style="margin-top:8px"><span class="alert-icon">‚ö†Ô∏è</span><div>After restore, update the etcd static pod manifest <code>--data-dir</code> to the new path, then restart kubelet.</div></div>
      </div>
    </div>

    <div class="comp-card" onclick="toggleComp(this)">
      <div class="comp-head"><span class="comp-emoji">üìÖ</span><div class="comp-info"><div class="comp-name">kube-scheduler</div><div class="comp-type">Control Plane ¬∑ Filter ‚Üí Score ‚Üí Bind</div></div><span class="comp-toggle">‚ñ∂</span></div>
      <div class="comp-body">
        <div class="comp-desc">Two-phase: Filter (removes unviable nodes by resources, taints, affinity) then Score (ranks by priority functions). Writes binding to etcd via API Server.</div>
        <div class="code-block"><span class="comment"># nodeSelector ‚Äî simple label matching</span>
<span class="key">nodeSelector:</span>
  <span class="val">disktype: ssd</span>

<span class="comment"># nodeName ‚Äî bypass scheduler entirely</span>
<span class="key">nodeName:</span> <span class="val">node01</span>

<span class="comment"># Taint a node</span>
kubectl taint nodes node01 <span class="str">key=value:NoSchedule</span></div>
      </div>
    </div>

    <div class="comp-card" onclick="toggleComp(this)">
      <div class="comp-head"><span class="comp-emoji">ü§ñ</span><div class="comp-info"><div class="comp-name">kubelet</div><div class="comp-type">Worker Node ¬∑ Port 10250 ¬∑ systemd service</div></div><span class="comp-toggle">‚ñ∂</span></div>
      <div class="comp-body">
        <div class="comp-desc">Node agent. NOT a static pod ‚Äî runs as a systemd service. Receives PodSpecs, calls CRI (containerd), runs probes, reports status. Config at /var/lib/kubelet/config.yaml.</div>
        <div class="code-block"><span class="comment"># Check kubelet</span>
systemctl status kubelet
journalctl -u kubelet -n 50 --no-pager

<span class="comment"># Restart after config change</span>
systemctl daemon-reload && systemctl restart kubelet</div>
        <div class="alert alert-danger" style="margin-top:8px"><span class="alert-icon">üö®</span><div>Most common node issue in exam. Always check <code>systemctl status kubelet</code> and <code>journalctl -u kubelet</code> first.</div></div>
      </div>
    </div>

    <div class="comp-card" onclick="toggleComp(this)">
      <div class="comp-head"><span class="comp-emoji">‚¨ÜÔ∏è</span><div class="comp-info"><div class="comp-name">Cluster Upgrade (kubeadm)</div><div class="comp-type">High Exam Frequency ‚ö°</div></div><span class="comp-toggle">‚ñ∂</span></div>
      <div class="comp-body">
        <div class="comp-desc">Upgrade control plane first, then workers. One minor version at a time only.</div>
        <div class="code-block"><span class="comment"># 1. Upgrade kubeadm on control-plane</span>
apt-mark unhold kubeadm
apt-get install -y kubeadm=1.30.0-00
apt-mark hold kubeadm

<span class="comment"># 2. Plan and apply</span>
kubeadm upgrade plan
kubeadm upgrade apply v1.30.0

<span class="comment"># 3. Drain node</span>
kubectl drain controlplane --ignore-daemonsets

<span class="comment"># 4. Upgrade kubelet + kubectl</span>
apt-get install -y kubelet=1.30.0-00 kubectl=1.30.0-00
systemctl daemon-reload && systemctl restart kubelet

<span class="comment"># 5. Uncordon</span>
kubectl uncordon controlplane

<span class="comment"># Worker nodes: use kubeadm upgrade node (not apply)</span></div>
      </div>
    </div>

    <div class="comp-card" onclick="toggleComp(this)">
      <div class="comp-head"><span class="comp-emoji">üîÑ</span><div class="comp-info"><div class="comp-name">kube-controller-manager</div><div class="comp-type">Control Plane ¬∑ Reconciliation Loops</div></div><span class="comp-toggle">‚ñ∂</span></div>
      <div class="comp-body">
        <div class="comp-desc">Runs control loops: ReplicaSet, Node, Endpoints, ServiceAccount, Job, CronJob controllers. Watch ‚Üí Diff ‚Üí Act. This is how K8s self-heals.</div>
        <div class="code-block"><span class="comment"># Key controllers</span>
<span class="comment"># ReplicaSet ‚Üí ensures N pods running</span>
<span class="comment"># Node ctrl ‚Üí evicts pods after 5min no heartbeat</span>
<span class="comment"># Job ctrl ‚Üí creates pods for batch workloads</span>

kubectl get pods -n kube-system | grep controller</div>
      </div>
    </div>
  </div>
</section>

<!-- WORKLOADS -->
<section class="section anchor" id="workloads">
  <div class="section-hd">
    <span class="section-icon">‚öôÔ∏è</span>
    <h2 class="section-title">Workloads &amp; Controllers</h2>
    <span class="section-weight">15% of exam</span>
  </div>
  <div class="concept-grid">
    <div class="concept-card"><div class="cc-icon">üöÄ</div><div class="cc-title">Deployment</div><div class="cc-body">Manages a ReplicaSet, which manages pods. Rolling updates (maxSurge/maxUnavailable), rollback. Standard for stateless apps.</div><span class="cc-tag tag-blue">STATELESS</span></div>
    <div class="concept-card"><div class="cc-icon">üìä</div><div class="cc-title">StatefulSet</div><div class="cc-body">Stable pod identity (pod-0, pod-1), stable storage, ordered creation/deletion. Required for databases, Kafka, Zookeeper.</div><span class="cc-tag tag-yellow">STATEFUL</span></div>
    <div class="concept-card"><div class="cc-icon">üëÅÔ∏è</div><div class="cc-title">DaemonSet</div><div class="cc-body">One pod per node. Used for node-level logging (Fluentd), monitoring (node-exporter), and CNI/kube-proxy themselves.</div><span class="cc-tag tag-green">NODE AGENTS</span></div>
    <div class="concept-card"><div class="cc-icon">‚ö°</div><div class="cc-title">Job &amp; CronJob</div><div class="cc-body">Job: runs to completion. CronJob: creates Jobs on a cron schedule. Key fields: completions, parallelism, backoffLimit, concurrencyPolicy.</div><span class="cc-tag tag-purple">BATCH</span></div>
    <div class="concept-card"><div class="cc-icon">üîÄ</div><div class="cc-title">Rolling Updates</div><div class="cc-body">kubectl set image / kubectl rollout. maxSurge (extra pods during update), maxUnavailable (pods that can be down simultaneously).</div><span class="cc-tag tag-blue">ZERO DOWNTIME</span></div>
    <div class="concept-card"><div class="cc-icon">üì¶</div><div class="cc-title">Init Containers</div><div class="cc-body">Run sequentially before main containers start. Must complete successfully. Used for setup, waiting for dependencies.</div><span class="cc-tag tag-green">LIFECYCLE</span></div>
  </div>

  <hr>
  <div class="code-label">Critical kubectl commands for workloads</div>
  <div class="code-block"><span class="comment"># Create imperatively (fastest in exam)</span>
kubectl create deployment nginx --image=nginx:1.21 --replicas=3
kubectl scale deployment nginx --replicas=5
kubectl set image deployment/nginx nginx=nginx:1.22

<span class="comment"># Rollout management</span>
kubectl rollout status deployment/nginx
kubectl rollout history deployment/nginx
kubectl rollout undo deployment/nginx
kubectl rollout undo deployment/nginx --to-revision=2

<span class="comment"># Pause/resume (useful for multiple changes)</span>
kubectl rollout pause deployment/nginx
kubectl rollout resume deployment/nginx</div>

  <hr>
  <div class="code-label">Resource limits ‚Äî every pod should have these</div>
  <div class="code-block"><span class="key">resources:</span>
  <span class="key">requests:</span>       <span class="comment"># reserved on node, used for scheduling</span>
    <span class="key">memory:</span> <span class="val">"64Mi"</span>
    <span class="key">cpu:</span>    <span class="val">"250m"</span>    <span class="comment"># 250 millicores = 0.25 CPU</span>
  <span class="key">limits:</span>         <span class="comment"># hard ceiling</span>
    <span class="key">memory:</span> <span class="val">"128Mi"</span>  <span class="comment"># OOMKilled if exceeded</span>
    <span class="key">cpu:</span>    <span class="val">"500m"</span>    <span class="comment"># throttled if exceeded</span></div>
  <div class="alert alert-info"><span class="alert-icon">‚ÑπÔ∏è</span><div><strong>QoS Classes:</strong> Guaranteed (requests=limits for all containers) ‚Üí Burstable (some requests set) ‚Üí BestEffort (none set). Guaranteed pods are the last evicted under node pressure.</div></div>
</section>

<!-- SCHEDULING -->
<section class="section anchor" id="scheduling">
  <div class="section-hd">
    <span class="section-icon">üìÖ</span>
    <h2 class="section-title">Advanced Scheduling</h2>
  </div>
  <div class="comp-grid">
    <div class="comp-card" onclick="toggleComp(this)">
      <div class="comp-head"><span class="comp-emoji">üè∑Ô∏è</span><div class="comp-info"><div class="comp-name">Node Affinity</div><div class="comp-type">Required or preferred node selection</div></div><span class="comp-toggle">‚ñ∂</span></div>
      <div class="comp-body">
        <div class="comp-desc">More expressive than nodeSelector. "required" is a hard rule; "preferred" is a soft preference. Both are IgnoredDuringExecution (won't evict running pods if rule stops matching).</div>
        <div class="code-block"><span class="key">affinity:</span>
  <span class="key">nodeAffinity:</span>
    <span class="key">requiredDuringSchedulingIgnoredDuringExecution:</span>
      <span class="key">nodeSelectorTerms:</span>
      <span class="val">- matchExpressions:
        - key: kubernetes.io/os
          operator: In
          values: [linux]</span>
    <span class="key">preferredDuringSchedulingIgnoredDuringExecution:</span>
    <span class="val">- weight: 1
      preference:
        matchExpressions:
        - key: disktype
          operator: In
          values: [ssd]</span></div>
      </div>
    </div>
    <div class="comp-card" onclick="toggleComp(this)">
      <div class="comp-head"><span class="comp-emoji">üö´</span><div class="comp-info"><div class="comp-name">Taints &amp; Tolerations</div><div class="comp-type">Repel pods from nodes</div></div><span class="comp-toggle">‚ñ∂</span></div>
      <div class="comp-body">
        <div class="comp-desc">Taints go on nodes (repel pods). Tolerations go on pods (allow scheduling despite taint). Effects: NoSchedule, PreferNoSchedule, NoExecute (evicts existing pods).</div>
        <div class="code-block"><span class="comment"># Taint a node</span>
kubectl taint nodes node01 dedicated=gpu:<span class="val">NoSchedule</span>

<span class="comment"># Remove taint (trailing -)</span>
kubectl taint nodes node01 dedicated=gpu:NoSchedule<span class="flag">-</span>

<span class="comment"># Pod toleration</span>
<span class="key">tolerations:</span>
<span class="val">- key: "dedicated"
  operator: "Equal"
  value: "gpu"
  effect: "NoSchedule"</span></div>
      </div>
    </div>
    <div class="comp-card" onclick="toggleComp(this)">
      <div class="comp-head"><span class="comp-emoji">üîí</span><div class="comp-info"><div class="comp-name">LimitRange &amp; ResourceQuota</div><div class="comp-type">Namespace resource enforcement</div></div><span class="comp-toggle">‚ñ∂</span></div>
      <div class="comp-body">
        <div class="comp-desc">LimitRange: default/min/max per container in a namespace. ResourceQuota: limits total resource consumption across all objects in a namespace.</div>
        <div class="code-block"><span class="key">kind:</span> LimitRange
<span class="key">spec:</span>
  <span class="key">limits:</span>
  <span class="val">- default:
      cpu: 500m
    defaultRequest:
      cpu: 200m
    type: Container</span>
---
<span class="key">kind:</span> ResourceQuota
<span class="key">spec:</span>
  <span class="key">hard:</span>
    <span class="val">pods: "10"
    requests.cpu: "4"
    limits.memory: 8Gi</span></div>
      </div>
    </div>
  </div>
</section>

<!-- NETWORKING -->
<section class="section anchor" id="networking">
  <div class="section-hd">
    <span class="section-icon">üåê</span>
    <h2 class="section-title">Services &amp; Networking</h2>
    <span class="section-weight">20% of exam</span>
  </div>
  <div class="concept-grid" style="margin-bottom:16px">
    <div class="concept-card"><div class="cc-icon">üîµ</div><div class="cc-title">ClusterIP</div><div class="cc-body">Default. Internal virtual IP. Only reachable inside the cluster. DNS: <code>svc.ns.svc.cluster.local</code>. kube-proxy programs iptables rules.</div><span class="cc-tag tag-blue">INTERNAL ONLY</span></div>
    <div class="concept-card"><div class="cc-icon">üî¥</div><div class="cc-title">NodePort</div><div class="cc-body">Exposes on every node's IP at a static port (30000‚Äì32767). Traffic: NodeIP:NodePort ‚Üí ClusterIP ‚Üí Pod. Good for dev/testing.</div><span class="cc-tag tag-yellow">EXTERNAL</span></div>
    <div class="concept-card"><div class="cc-icon">üü¢</div><div class="cc-title">LoadBalancer</div><div class="cc-body">Extends NodePort. Provisions a cloud load balancer via CCM. External IP assigned automatically on AWS/GCP/Azure.</div><span class="cc-tag tag-green">CLOUD LB</span></div>
    <div class="concept-card"><div class="cc-icon">‚¨õ</div><div class="cc-title">Headless Service</div><div class="cc-body">ClusterIP: None. DNS returns individual pod IPs. Required by StatefulSets so each pod is directly addressable (pod-0.svc-name...).</div><span class="cc-tag tag-purple">STATEFULSET</span></div>
  </div>

  <div class="comp-grid">
    <div class="comp-card" onclick="toggleComp(this)">
      <div class="comp-head"><span class="comp-emoji">üö™</span><div class="comp-info"><div class="comp-name">Ingress</div><div class="comp-type">L7 HTTP/HTTPS routing</div></div><span class="comp-toggle">‚ñ∂</span></div>
      <div class="comp-body">
        <div class="comp-desc">Defines routing rules. An Ingress Controller (nginx-ingress, Traefik) watches these and configures itself. Without a controller, Ingress objects do nothing.</div>
        <div class="code-block"><span class="key">apiVersion:</span> networking.k8s.io/v1
<span class="key">kind:</span> Ingress
<span class="key">metadata:</span>
  <span class="key">name:</span> my-ingress
<span class="key">spec:</span>
  <span class="key">ingressClassName:</span> nginx
  <span class="key">rules:</span>
  <span class="val">- host: myapp.example.com
    http:
      paths:
      - path: /api
        pathType: Prefix
        backend:
          service:
            name: api-service
            port:
              number: 80</span></div>
      </div>
    </div>
    <div class="comp-card" onclick="toggleComp(this)">
      <div class="comp-head"><span class="comp-emoji">üîí</span><div class="comp-info"><div class="comp-name">NetworkPolicy</div><div class="comp-type">Pod firewall rules ‚Äî HIGH FREQ ‚ö°</div></div><span class="comp-toggle">‚ñ∂</span></div>
      <div class="comp-body">
        <div class="comp-desc">Controls traffic between pods. Default: all traffic allowed. Once any NetworkPolicy selects a pod, all unmatched traffic is denied. Requires CNI support (Calico, Cilium).</div>
        <div class="code-block"><span class="comment"># Allow only from pods with app=frontend</span>
<span class="key">spec:</span>
  <span class="key">podSelector:</span>
    <span class="key">matchLabels:</span>
      <span class="val">app: backend</span>
  <span class="key">policyTypes:</span> <span class="val">[ Ingress ]</span>
  <span class="key">ingress:</span>
  <span class="val">- from:
    - podSelector:
        matchLabels:
          app: frontend</span>

<span class="comment"># Default deny ALL ingress</span>
<span class="key">spec:</span>
  <span class="key">podSelector:</span> <span class="val">{}</span>
  <span class="key">policyTypes:</span> <span class="val">[ Ingress ]</span></div>
      </div>
    </div>
    <div class="comp-card" onclick="toggleComp(this)">
      <div class="comp-head"><span class="comp-emoji">üß≠</span><div class="comp-info"><div class="comp-name">CoreDNS</div><div class="comp-type">Cluster DNS ¬∑ Port 53</div></div><span class="comp-toggle">‚ñ∂</span></div>
      <div class="comp-body">
        <div class="comp-desc">Runs in kube-system as a Deployment. Resolves service names to ClusterIPs. Every pod has /etc/resolv.conf pointing to CoreDNS ClusterIP.</div>
        <div class="code-block"><span class="comment"># DNS name formats</span>
svc-name                              <span class="comment"># same namespace</span>
svc-name.namespace.svc.cluster.local  <span class="comment"># FQDN</span>

<span class="comment"># Debug DNS</span>
kubectl run -it --rm debug --image=busybox:1.28 -- nslookup kubernetes
kubectl exec mypod -- cat /etc/resolv.conf</div>
      </div>
    </div>
  </div>
</section>

<!-- STORAGE -->
<section class="section anchor" id="storage">
  <div class="section-hd">
    <span class="section-icon">üíæ</span>
    <h2 class="section-title">Storage</h2>
    <span class="section-weight">10% of exam</span>
  </div>
  <div class="two-col">
    <div>
      <div class="code-label">PV + PVC YAML</div>
      <div class="code-block"><span class="key">apiVersion:</span> v1
<span class="key">kind:</span> PersistentVolume
<span class="key">metadata:</span>
  <span class="key">name:</span> my-pv
<span class="key">spec:</span>
  <span class="key">capacity:</span>
    <span class="key">storage:</span> <span class="val">1Gi</span>
  <span class="key">accessModes:</span> <span class="val">[ ReadWriteOnce ]</span>
  <span class="key">reclaimPolicy:</span> <span class="val">Retain</span>
  <span class="key">hostPath:</span>
    <span class="key">path:</span> <span class="val">/data/pv</span>
---
<span class="key">apiVersion:</span> v1
<span class="key">kind:</span> PersistentVolumeClaim
<span class="key">metadata:</span>
  <span class="key">name:</span> my-pvc
<span class="key">spec:</span>
  <span class="key">accessModes:</span> <span class="val">[ ReadWriteOnce ]</span>
  <span class="key">resources:</span>
    <span class="key">requests:</span>
      <span class="key">storage:</span> <span class="val">500Mi</span></div>
    </div>
    <div>
      <div class="code-label">Mount PVC in pod</div>
      <div class="code-block"><span class="key">spec:</span>
  <span class="key">volumes:</span>
  <span class="val">- name: my-vol
    persistentVolumeClaim:
      claimName: my-pvc</span>
  <span class="key">containers:</span>
  <span class="val">- name: app
    image: nginx
    volumeMounts:
    - mountPath: "/data"
      name: my-vol</span></div>

      <div class="code-label" style="margin-top:12px">Access Modes</div>
      <div class="code-block"><span class="val">ReadWriteOnce (RWO)</span>  <span class="comment"># one node, r/w</span>
<span class="val">ReadOnlyMany  (ROX)</span>  <span class="comment"># many nodes, read-only</span>
<span class="val">ReadWriteMany (RWX)</span>  <span class="comment"># many nodes, r/w</span>
<span class="val">ReadWriteOncePod</span>     <span class="comment"># single pod (1.22+)</span></div>

      <div class="code-label" style="margin-top:12px">Reclaim Policies</div>
      <div class="code-block"><span class="val">Retain</span>   <span class="comment"># PV kept, manual cleanup</span>
<span class="val">Delete</span>   <span class="comment"># PV + storage deleted</span>
<span class="val">Recycle</span>  <span class="comment"># deprecated</span></div>
    </div>
  </div>
</section>

<!-- SECURITY -->
<section class="section anchor" id="security">
  <div class="section-hd">
    <span class="section-icon">üîê</span>
    <h2 class="section-title">Security &amp; RBAC</h2>
    <span class="section-weight">12% of exam</span>
  </div>
  <div class="comp-grid">
    <div class="comp-card" onclick="toggleComp(this)">
      <div class="comp-head"><span class="comp-emoji">üë§</span><div class="comp-info"><div class="comp-name">RBAC ‚Äî Roles &amp; Bindings</div><div class="comp-type">HIGH EXAM FREQUENCY ‚ö°</div></div><span class="comp-toggle">‚ñ∂</span></div>
      <div class="comp-body">
        <div class="comp-desc">Role (namespace) / ClusterRole (cluster-wide). Bind to Users, Groups, or ServiceAccounts via RoleBinding / ClusterRoleBinding.</div>
        <div class="code-block"><span class="comment"># Create Role</span>
kubectl create role pod-reader \
  --verb=get,list,watch \
  --resource=pods -n default

<span class="comment"># Bind to user</span>
kubectl create rolebinding read-pods \
  --role=pod-reader --user=jane -n default

<span class="comment"># ClusterRole + binding</span>
kubectl create clusterrole node-viewer \
  --verb=get,list --resource=nodes
kubectl create clusterrolebinding view-nodes \
  --clusterrole=node-viewer --user=jane

<span class="comment"># Test permissions!</span>
kubectl auth can-i create pods --as=jane -n default
kubectl auth can-i '*' '*'</div>
      </div>
    </div>
    <div class="comp-card" onclick="toggleComp(this)">
      <div class="comp-head"><span class="comp-emoji">üõ°Ô∏è</span><div class="comp-info"><div class="comp-name">Security Context</div><div class="comp-type">Pod/Container level security</div></div><span class="comp-toggle">‚ñ∂</span></div>
      <div class="comp-body">
        <div class="comp-desc">Defines privilege and access controls at pod or container level. Container-level settings override pod-level.</div>
        <div class="code-block"><span class="key">spec:</span>
  <span class="key">securityContext:</span>          <span class="comment"># pod level</span>
    <span class="key">runAsUser:</span> <span class="val">1000</span>
    <span class="key">runAsGroup:</span> <span class="val">3000</span>
    <span class="key">fsGroup:</span> <span class="val">2000</span>
  <span class="key">containers:</span>
  <span class="val">- name: app
    securityContext:        <span class="comment"># container level</span>
      allowPrivilegeEscalation: false
      readOnlyRootFilesystem: true
      capabilities:
        drop: [ALL]
        add: [NET_BIND_SERVICE]</span></div>
      </div>
    </div>
    <div class="comp-card" onclick="toggleComp(this)">
      <div class="comp-head"><span class="comp-emoji">üîë</span><div class="comp-info"><div class="comp-name">Certificates &amp; PKI</div><div class="comp-type">kubeadm cert management</div></div><span class="comp-toggle">‚ñ∂</span></div>
      <div class="comp-body">
        <div class="comp-desc">K8s uses mTLS for component communication. CA at /etc/kubernetes/pki/. Certs expire yearly by default. Know how to create a CSR and approve it.</div>
        <div class="code-block"><span class="comment"># Check expiry</span>
kubeadm certs check-expiration

<span class="comment"># Renew all certs</span>
kubeadm certs renew all

<span class="comment"># CSR workflow</span>
openssl genrsa -out jane.key 2048
openssl req -new -key jane.key -out jane.csr \
  -subj "/CN=jane/O=developers"
kubectl certificate approve jane</div>
      </div>
    </div>
  </div>
</section>

<!-- TROUBLESHOOTING -->
<section class="section anchor" id="troubleshoot">
  <div class="section-hd">
    <span class="section-icon">üîß</span>
    <h2 class="section-title">Troubleshooting</h2>
    <span class="section-weight">30% of exam</span>
  </div>
  <div class="alert alert-danger"><span class="alert-icon">üö®</span><div><strong>Worth 30% of the exam.</strong> Master a systematic methodology: kubectl describe ‚Üí logs ‚Üí node (journalctl, crictl) ‚Üí static pods (/etc/kubernetes/manifests).</div></div>
  <div class="comp-grid">
    <div class="comp-card" onclick="toggleComp(this)">
      <div class="comp-head"><span class="comp-emoji">üí•</span><div class="comp-info"><div class="comp-name">Pod Failures</div><div class="comp-type">CrashLoopBackOff, OOMKilled, Pending</div></div><span class="comp-toggle">‚ñ∂</span></div>
      <div class="comp-body">
        <div class="code-block"><span class="comment"># Step 1: Status and events</span>
kubectl get pod mypod -o wide
kubectl describe pod mypod   <span class="comment"># ‚Üê READ THE EVENTS SECTION!</span>

<span class="comment"># Step 2: Logs</span>
kubectl logs mypod
kubectl logs mypod --previous  <span class="comment"># crashed container logs!</span>
kubectl logs mypod -c mycontainer

<span class="comment"># Common states:</span>
<span class="val">Pending</span>         <span class="comment">‚Üí no node available (resources? taints?)</span>
<span class="val">CrashLoopBackOff</span> <span class="comment">‚Üí app crashes (use --previous)</span>
<span class="val">OOMKilled</span>       <span class="comment">‚Üí memory limit exceeded</span>
<span class="val">ImagePullBackOff</span> <span class="comment">‚Üí wrong image or missing pullSecret</span>
<span class="val">CreateContainerError</span> <span class="comment">‚Üí bad volume/configmap/secret</span></div>
      </div>
    </div>
    <div class="comp-card" onclick="toggleComp(this)">
      <div class="comp-head"><span class="comp-emoji">üñ•Ô∏è</span><div class="comp-info"><div class="comp-name">Node Issues</div><div class="comp-type">NotReady, disk/memory pressure</div></div><span class="comp-toggle">‚ñ∂</span></div>
      <div class="comp-body">
        <div class="code-block"><span class="comment"># Check node status</span>
kubectl get nodes
kubectl describe node node01  <span class="comment"># check Conditions</span>

<span class="comment"># SSH to node and check kubelet</span>
systemctl status kubelet
journalctl -u kubelet -n 100 --no-pager

<span class="comment"># Check container runtime</span>
systemctl status containerd
crictl ps    <span class="comment"># running containers</span>
crictl pods  <span class="comment"># pods</span>
crictl logs &lt;container-id&gt;</div>
      </div>
    </div>
    <div class="comp-card" onclick="toggleComp(this)">
      <div class="comp-head"><span class="comp-emoji">üèõÔ∏è</span><div class="comp-info"><div class="comp-name">Control Plane Issues</div><div class="comp-type">API Server, etcd, scheduler down</div></div><span class="comp-toggle">‚ñ∂</span></div>
      <div class="comp-body">
        <div class="code-block"><span class="comment"># Static pods live here</span>
ls /etc/kubernetes/manifests/

<span class="comment"># Check if static pods are running</span>
crictl ps | grep -E "apiserver|etcd|scheduler"

<span class="comment"># Edit manifest to fix, kubelet auto-restarts</span>
vi /etc/kubernetes/manifests/kube-apiserver.yaml

<span class="comment"># etcd health check</span>
ETCDCTL_API=3 etcdctl endpoint health \
  --endpoints=https://127.0.0.1:2379 \
  --cacert=/etc/kubernetes/pki/etcd/ca.crt \
  --cert=/etc/kubernetes/pki/etcd/server.crt \
  --key=/etc/kubernetes/pki/etcd/server.key</div>
      </div>
    </div>
    <div class="comp-card" onclick="toggleComp(this)">
      <div class="comp-head"><span class="comp-emoji">üåê</span><div class="comp-info"><div class="comp-name">Networking Debug</div><div class="comp-type">DNS, Service, connectivity</div></div><span class="comp-toggle">‚ñ∂</span></div>
      <div class="comp-body">
        <div class="code-block"><span class="comment"># Test DNS from inside cluster</span>
kubectl run -it --rm debug \
  --image=busybox:1.28 --restart=Never -- sh
nslookup my-service.my-namespace

<span class="comment"># Check service endpoints</span>
kubectl get endpoints my-service   <span class="comment"># should show pod IPs</span>
kubectl describe service my-service <span class="comment"># check selector</span>

<span class="comment"># Common issues:</span>
<span class="val">No endpoints</span>  <span class="comment">‚Üí selector labels don't match pod labels</span>
<span class="val">DNS fails</span>     <span class="comment">‚Üí CoreDNS pods down in kube-system</span>
<span class="val">NP blocking</span>  <span class="comment">‚Üí NetworkPolicy denying traffic</span></div>
      </div>
    </div>
  </div>
</section>

<!-- KUBECTL CHEATSHEET -->
<section class="section anchor" id="kubectl">
  <div class="section-hd">
    <span class="section-icon">‚å®Ô∏è</span>
    <h2 class="section-title">kubectl Cheatsheet</h2>
  </div>
  <div class="alert alert-tip"><span class="alert-icon">üí°</span><div>Set these aliases <strong>immediately</strong> at exam start ‚Äî they save enormous time.</div></div>
  <div class="code-block"><span class="comment"># Set IMMEDIATELY at exam start</span>
alias k=kubectl
export do="--dry-run=client -o yaml"
export now="--grace-period=0 --force"
source &lt;(kubectl completion bash)
complete -F __start_kubectl k
<span class="comment"># Set default namespace</span>
kubectl config set-context --current --namespace=my-ns</div>

  <div class="tabs" style="margin-top:20px">
    <button class="tab active" onclick="switchTab(event,'t-get')">Get / Describe</button>
    <button class="tab" onclick="switchTab(event,'t-create')">Create / Run</button>
    <button class="tab" onclick="switchTab(event,'t-edit')">Edit / Node</button>
    <button class="tab" onclick="switchTab(event,'t-debug')">Debug</button>
    <button class="tab" onclick="switchTab(event,'t-ctx')">Context</button>
  </div>

  <div id="t-get" class="tab-content active">
    <table class="cmd-table">
      <tr><th>Command</th><th>Description</th></tr>
      <tr><td>k get all -A</td><td>All resources, all namespaces</td></tr>
      <tr><td>k get pods -n kube-system -o wide</td><td>System pods with node/IP info</td></tr>
      <tr><td>k get events --sort-by=.lastTimestamp</td><td>Events sorted by time</td></tr>
      <tr><td>k describe pod mypod</td><td>Full details + events ‚Äî most useful command</td></tr>
      <tr><td>k get pod mypod -o yaml</td><td>Full YAML output to check any field</td></tr>
      <tr><td>k get pod mypod -o jsonpath='{.status.podIP}'</td><td>Extract specific field</td></tr>
      <tr><td>k top nodes</td><td>Node CPU/memory usage</td></tr>
      <tr><td>k top pods -A --sort-by=memory</td><td>Pod resource usage sorted</td></tr>
      <tr><td>k get pv,pvc -A</td><td>All persistent volumes and claims</td></tr>
    </table>
  </div>

  <div id="t-create" class="tab-content">
    <table class="cmd-table">
      <tr><th>Command</th><th>Description</th></tr>
      <tr><td>k create deploy nginx --image=nginx $do</td><td>Generate deployment YAML without applying</td></tr>
      <tr><td>k run mypod --image=busybox --restart=Never -- sleep 3600</td><td>Create standalone pod</td></tr>
      <tr><td>k expose deploy nginx --port=80 --type=NodePort</td><td>Create Service from deployment</td></tr>
      <tr><td>k create configmap myconfig --from-literal=key=val</td><td>ConfigMap from literal</td></tr>
      <tr><td>k create secret generic mysecret --from-literal=pass=s3cr3t</td><td>Opaque secret</td></tr>
      <tr><td>k create ns my-namespace</td><td>Create namespace</td></tr>
      <tr><td>k create job myjob --image=busybox -- echo hello</td><td>Create Job</td></tr>
      <tr><td>k create cronjob mycron --image=busybox --schedule="*/5 * * * *" -- date</td><td>Create CronJob</td></tr>
      <tr><td>k create sa my-sa</td><td>Create ServiceAccount</td></tr>
    </table>
  </div>

  <div id="t-edit" class="tab-content">
    <table class="cmd-table">
      <tr><th>Command</th><th>Description</th></tr>
      <tr><td>k edit deploy nginx</td><td>Edit in-place (opens $EDITOR)</td></tr>
      <tr><td>k set image deploy/nginx nginx=nginx:1.22</td><td>Update container image</td></tr>
      <tr><td>k scale deploy nginx --replicas=5</td><td>Scale replicas</td></tr>
      <tr><td>k label node node01 disktype=ssd</td><td>Add label to node</td></tr>
      <tr><td>k taint nodes node01 key=val:NoSchedule</td><td>Taint node</td></tr>
      <tr><td>k taint nodes node01 key=val:NoSchedule-</td><td>Remove taint (trailing -)</td></tr>
      <tr><td>k cordon node01</td><td>Prevent new scheduling on node</td></tr>
      <tr><td>k drain node01 --ignore-daemonsets --delete-emptydir-data</td><td>Evict all pods from node</td></tr>
      <tr><td>k uncordon node01</td><td>Re-enable scheduling</td></tr>
    </table>
  </div>

  <div id="t-debug" class="tab-content">
    <table class="cmd-table">
      <tr><th>Command</th><th>Description</th></tr>
      <tr><td>k logs mypod --previous</td><td>Crashed container logs</td></tr>
      <tr><td>k logs mypod -c container -f</td><td>Follow specific container logs</td></tr>
      <tr><td>k exec -it mypod -- /bin/sh</td><td>Shell into running pod</td></tr>
      <tr><td>k run tmp --image=busybox:1.28 --rm -it --restart=Never -- sh</td><td>Temporary debug pod (auto-deleted)</td></tr>
      <tr><td>k debug node/node01 -it --image=ubuntu</td><td>Debug node with privileged pod</td></tr>
      <tr><td>k auth can-i create pods --as=jane</td><td>Test RBAC permissions for user</td></tr>
      <tr><td>k auth can-i '*' '*'</td><td>Am I cluster-admin?</td></tr>
      <tr><td>k get events -n default --field-selector reason=Failed</td><td>Filter events by reason</td></tr>
    </table>
  </div>

  <div id="t-ctx" class="tab-content">
    <table class="cmd-table">
      <tr><th>Command</th><th>Description</th></tr>
      <tr><td>k config get-contexts</td><td>List all contexts (clusters)</td></tr>
      <tr><td>k config current-context</td><td>Show active context</td></tr>
      <tr><td>k config use-context cluster1</td><td>Switch cluster ‚Äî CRITICAL in exam</td></tr>
      <tr><td>k config set-context --current --namespace=dev</td><td>Set default namespace</td></tr>
      <tr><td>k cluster-info</td><td>Show cluster endpoints</td></tr>
      <tr><td>k version</td><td>Client and server K8s version</td></tr>
    </table>
  </div>
</section>

<!-- YAML TEMPLATES -->
<section class="section anchor" id="yaml">
  <div class="section-hd">
    <span class="section-icon">üìù</span>
    <h2 class="section-title">Essential YAML Templates</h2>
  </div>
  <div class="alert alert-info"><span class="alert-icon">‚ÑπÔ∏è</span><div>Always generate with <code>--dry-run=client -o yaml</code> in the exam. Use these templates only for fields that can't be generated imperatively.</div></div>
  <div class="two-col">
    <div>
      <div class="code-label">Deployment with probes + resources</div>
      <div class="code-block"><span class="key">apiVersion:</span> apps/v1
<span class="key">kind:</span> Deployment
<span class="key">metadata:</span>
  <span class="key">name:</span> my-deploy
<span class="key">spec:</span>
  <span class="key">replicas:</span> <span class="val">3</span>
  <span class="key">selector:</span>
    <span class="key">matchLabels:</span>
      <span class="val">app: my-app</span>
  <span class="key">strategy:</span>
    <span class="key">rollingUpdate:</span>
      <span class="key">maxSurge:</span> <span class="val">1</span>
      <span class="key">maxUnavailable:</span> <span class="val">0</span>
  <span class="key">template:</span>
    <span class="key">metadata:</span>
      <span class="key">labels:</span>
        <span class="val">app: my-app</span>
    <span class="key">spec:</span>
      <span class="key">containers:</span>
      <span class="val">- name: app
        image: nginx:1.21
        ports:
        - containerPort: 80
        resources:
          requests: {cpu: 100m, memory: 64Mi}
          limits: {cpu: 200m, memory: 128Mi}
        livenessProbe:
          httpGet: {path: /, port: 80}
          initialDelaySeconds: 10
        readinessProbe:
          httpGet: {path: /ready, port: 80}
          periodSeconds: 5</span></div>
    </div>
    <div>
      <div class="code-label">Multi-container pod with init container</div>
      <div class="code-block"><span class="key">apiVersion:</span> v1
<span class="key">kind:</span> Pod
<span class="key">spec:</span>
  <span class="key">initContainers:</span>
  <span class="val">- name: wait
    image: busybox
    command: ['sh','-c',
      'until nc -z db 5432; do sleep 2; done']</span>
  <span class="key">containers:</span>
  <span class="val">- name: app
    image: myapp:1.0
    env:
    - name: DB_PASS
      valueFrom:
        secretKeyRef:
          name: db-secret
          key: password
    - name: ENV
      valueFrom:
        configMapKeyRef:
          name: app-config
          key: environment
    volumeMounts:
    - name: shared
      mountPath: /data
  - name: sidecar
    image: busybox
    command: ['sh','-c',
      'while true; do ls /data; sleep 10; done']
    volumeMounts:
    - name: shared
      mountPath: /data</span>
  <span class="key">volumes:</span>
  <span class="val">- name: shared
    emptyDir: {}</span></div>
    </div>
  </div>
</section>

<!-- EXAM CHECKLIST -->
<section class="section anchor" id="checklist">
  <div class="section-hd">
    <span class="section-icon">‚úÖ</span>
    <h2 class="section-title">Exam Day Checklist</h2>
  </div>
  <div class="alert alert-warn"><span class="alert-icon">‚ö†Ô∏è</span><div>Track your readiness ‚Äî click items to mark as complete. Progress updates in the sidebar.</div></div>
  <div class="two-col">
    <div>
      <div class="code-label" style="margin-bottom:8px">Cluster Administration</div>
      <ul class="checklist">
        <li onclick="toggleCheck(this)"><span class="chk-box">‚úì</span>Upgrade cluster with kubeadm (minor version)</li>
        <li onclick="toggleCheck(this)"><span class="chk-box">‚úì</span>Backup and restore etcd from snapshot</li>
        <li onclick="toggleCheck(this)"><span class="chk-box">‚úì</span>Join a new worker node to cluster</li>
        <li onclick="toggleCheck(this)"><span class="chk-box">‚úì</span>Configure RBAC: Role, ClusterRole, bindings</li>
        <li onclick="toggleCheck(this)"><span class="chk-box">‚úì</span>Create and use ServiceAccount in a pod</li>
        <li onclick="toggleCheck(this)"><span class="chk-box">‚úì</span>Approve a CertificateSigningRequest</li>
        <li onclick="toggleCheck(this)"><span class="chk-box">‚úì</span>Use kubectl auth can-i to test permissions</li>
      </ul>
      <div class="code-label" style="margin:16px 0 8px">Workloads</div>
      <ul class="checklist">
        <li onclick="toggleCheck(this)"><span class="chk-box">‚úì</span>Create Deployment and perform rolling update</li>
        <li onclick="toggleCheck(this)"><span class="chk-box">‚úì</span>Roll back a deployment to previous revision</li>
        <li onclick="toggleCheck(this)"><span class="chk-box">‚úì</span>Configure liveness and readiness probes</li>
        <li onclick="toggleCheck(this)"><span class="chk-box">‚úì</span>Mount ConfigMap as volume and env vars</li>
        <li onclick="toggleCheck(this)"><span class="chk-box">‚úì</span>Mount Secret as env var in pod</li>
        <li onclick="toggleCheck(this)"><span class="chk-box">‚úì</span>Create multi-container pod with shared volume</li>
        <li onclick="toggleCheck(this)"><span class="chk-box">‚úì</span>Create pod with init container</li>
        <li onclick="toggleCheck(this)"><span class="chk-box">‚úì</span>Create Job and CronJob</li>
        <li onclick="toggleCheck(this)"><span class="chk-box">‚úì</span>Set resource requests and limits</li>
      </ul>
    </div>
    <div>
      <div class="code-label" style="margin-bottom:8px">Scheduling &amp; Networking</div>
      <ul class="checklist">
        <li onclick="toggleCheck(this)"><span class="chk-box">‚úì</span>Taint a node and add toleration to pod</li>
        <li onclick="toggleCheck(this)"><span class="chk-box">‚úì</span>Schedule pod to specific node (nodeSelector)</li>
        <li onclick="toggleCheck(this)"><span class="chk-box">‚úì</span>Configure node affinity rules</li>
        <li onclick="toggleCheck(this)"><span class="chk-box">‚úì</span>Create NetworkPolicy to restrict traffic</li>
        <li onclick="toggleCheck(this)"><span class="chk-box">‚úì</span>Create Service (ClusterIP, NodePort)</li>
        <li onclick="toggleCheck(this)"><span class="chk-box">‚úì</span>Configure Ingress with path-based routing</li>
        <li onclick="toggleCheck(this)"><span class="chk-box">‚úì</span>Debug a service with no endpoints</li>
        <li onclick="toggleCheck(this)"><span class="chk-box">‚úì</span>Debug DNS resolution from inside a pod</li>
      </ul>
      <div class="code-label" style="margin:16px 0 8px">Storage &amp; Troubleshooting</div>
      <ul class="checklist">
        <li onclick="toggleCheck(this)"><span class="chk-box">‚úì</span>Create PV and PVC and use in pod</li>
        <li onclick="toggleCheck(this)"><span class="chk-box">‚úì</span>Fix pod in CrashLoopBackOff</li>
        <li onclick="toggleCheck(this)"><span class="chk-box">‚úì</span>Fix a Pending pod (resources/taints/affinity)</li>
        <li onclick="toggleCheck(this)"><span class="chk-box">‚úì</span>Fix broken worker node (kubelet issues)</li>
        <li onclick="toggleCheck(this)"><span class="chk-box">‚úì</span>Fix broken control plane static pod</li>
        <li onclick="toggleCheck(this)"><span class="chk-box">‚úì</span>Use crictl to debug containers on a node</li>
        <li onclick="toggleCheck(this)"><span class="chk-box">‚úì</span>Drain and uncordon a node safely</li>
        <li onclick="toggleCheck(this)"><span class="chk-box">‚úì</span>Read journalctl output for kubelet</li>
      </ul>
    </div>
  </div>
</section>

    <!-- Comments -->
    <section class="comments-section" id="comments" aria-label="Comments" style="max-width:800px;margin:2rem auto;padding:2rem 1rem;border-top:1px solid var(--border);">
      <h2 class="comments-title" style="font-size:1rem;font-weight:600;margin:0 0 1rem;">Comments</h2>
      <script src="https://utteranc.es/client.js"
              repo="SKCloudOps/k8s"
              issue-term="pathname"
              theme="github-light"
              crossorigin="anonymous"
              async>
      </script>
    </section>

</div><!-- end content -->
</main>
</div><!-- end layout -->

<script>
// ===== COMPONENT CARDS =====
function toggleComp(card) { card.classList.toggle('open'); }

// ===== TABS =====
function switchTab(e, id) {
  const section = e.target.closest('section') || e.target.closest('.content');
  section.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
  section.querySelectorAll('.tab-content').forEach(t => t.classList.remove('active'));
  e.target.classList.add('active');
  const el = document.getElementById(id);
  if (el) el.classList.add('active');
}

// ===== CHECKLIST =====
function toggleCheck(li) {
  li.classList.toggle('checked');
  updateProgress();
}

function updateProgress() {
  const total = document.querySelectorAll('.checklist li').length;
  const done = document.querySelectorAll('.checklist li.checked').length;
  const pct = Math.round((done / total) * 100);
  document.getElementById('progressFill').style.width = pct + '%';
  document.getElementById('progressPct').textContent = pct + '%';
}

// ===== NAV HIGHLIGHT =====
const sections = document.querySelectorAll('.anchor');
const navLinks = document.querySelectorAll('.nav-item');
const io = new IntersectionObserver((entries) => {
  entries.forEach(e => {
    if (e.isIntersecting) {
      navLinks.forEach(n => n.classList.toggle('active', n.getAttribute('href') === '#' + e.target.id));
    }
  });
}, { threshold: 0.15, rootMargin: '-60px 0px -55% 0px' });
sections.forEach(s => io.observe(s));

// ===== MOCK EXAM ENGINE =====
const QUESTIONS = [
  {
    id: 1, type: 'mcq',
    domain: 'Architecture', domainColor: '#dbeafe', domainText: '#1d4ed8',
    difficulty: 'easy',
    text: 'Which component is the ONLY one allowed to communicate directly with etcd?',
    options: ['kube-scheduler', 'kube-apiserver', 'kubelet', 'kube-controller-manager'],
    correct: 1,
    explanation: 'The kube-apiserver is the sole gateway to etcd. All other components (scheduler, controller-manager, kubelet) interact with etcd indirectly by making API calls to the API Server. This design ensures a single point of access for cluster state.',
    expCode: 'kubectl get componentstatuses  # verify control plane health'
  },
  {
    id: 2, type: 'task',
    domain: 'Architecture', domainColor: '#dbeafe', domainText: '#1d4ed8',
    difficulty: 'hard',
    text: 'The etcd on the control-plane node must be backed up.',
    scenario: 'Take a snapshot of the etcd database. The etcd data directory is /var/lib/etcd. The certificates are located at /etc/kubernetes/pki/etcd/. Save the backup to /opt/etcd-backup.db.',
    answer: `ETCDCTL_API=3 etcdctl snapshot save /opt/etcd-backup.db \\
  --endpoints=https://127.0.0.1:2379 \\
  --cacert=/etc/kubernetes/pki/etcd/ca.crt \\
  --cert=/etc/kubernetes/pki/etcd/server.crt \\
  --key=/etc/kubernetes/pki/etcd/server.key`,
    explanation: 'etcdctl requires ETCDCTL_API=3 and all three certificate flags. Forgetting the --cacert, --cert, or --key will result in authentication failure. Always verify with: ETCDCTL_API=3 etcdctl snapshot status /opt/etcd-backup.db',
    expCode: `ETCDCTL_API=3 etcdctl snapshot save /opt/etcd-backup.db \\
  --endpoints=https://127.0.0.1:2379 \\
  --cacert=/etc/kubernetes/pki/etcd/ca.crt \\
  --cert=/etc/kubernetes/pki/etcd/server.crt \\
  --key=/etc/kubernetes/pki/etcd/server.key`
  },
  {
    id: 3, type: 'mcq',
    domain: 'Scheduling', domainColor: '#ede9fe', domainText: '#6d28d9',
    difficulty: 'medium',
    text: 'A pod has the following taint on its target node: key=env:NoExecute. Which toleration correctly allows this pod to run AND not be evicted from that node?',
    options: [
      'tolerations: [{key: "env", operator: "Exists", effect: "NoSchedule"}]',
      'tolerations: [{key: "env", operator: "Exists", effect: "NoExecute"}]',
      'tolerations: [{key: "env", operator: "Equal", value: "env", effect: "NoExecute"}]',
      'tolerations: [{key: "env", effect: "NoExecute", tolerationSeconds: 0}]'
    ],
    correct: 1,
    explanation: 'The effect must match exactly ‚Äî NoExecute prevents both scheduling AND evicts existing pods. Using operator: Exists matches any value for that key. Options A uses wrong effect (NoSchedule). Option C uses wrong value (key is "env" with no value in the taint). Option D sets tolerationSeconds: 0 which means evict immediately.',
    expCode: `tolerations:
- key: "env"
  operator: "Exists"
  effect: "NoExecute"`
  },
  {
    id: 4, type: 'task',
    domain: 'Workloads', domainColor: '#dcfce7', domainText: '#166534',
    difficulty: 'easy',
    text: 'Create a deployment named webapp using the nginx:1.21 image with 3 replicas.',
    scenario: 'The deployment should be in the default namespace. After creating it, update the image to nginx:1.22 without causing downtime (ensure maxUnavailable=0). Then check the rollout status.',
    answer: `kubectl create deployment webapp --image=nginx:1.21 --replicas=3
kubectl patch deployment webapp -p '{"spec":{"strategy":{"rollingUpdate":{"maxUnavailable":0}}}}'
kubectl set image deployment/webapp nginx=nginx:1.22
kubectl rollout status deployment/webapp`,
    explanation: 'Creating imperatively is fastest. To guarantee zero downtime, set maxUnavailable=0 before updating (default is 25%). kubectl rollout status blocks until complete. Always verify with kubectl get pods to confirm all new pods are running.',
    expCode: `kubectl create deployment webapp --image=nginx:1.21 --replicas=3
kubectl set image deployment/webapp nginx=nginx:1.22
kubectl rollout status deployment/webapp
kubectl rollout history deployment/webapp`
  },
  {
    id: 5, type: 'mcq',
    domain: 'Networking', domainColor: '#fef3c7', domainText: '#92400e',
    difficulty: 'medium',
    text: 'A NetworkPolicy exists that selects pods with label app=backend and sets policyTypes: [Ingress] with an empty ingress array ([]). What is the result?',
    options: [
      'All ingress traffic to backend pods is allowed',
      'All ingress traffic to backend pods is denied',
      'Only traffic from the same namespace is allowed',
      'The NetworkPolicy has no effect until an ingress rule is added'
    ],
    correct: 1,
    explanation: 'When policyTypes includes Ingress but the ingress array is empty ([]), it means no traffic source is whitelisted ‚Äî resulting in ALL ingress traffic being denied. This is the "default deny" pattern. An empty ingress array is NOT the same as omitting the ingress field.',
    expCode: `# Default deny all ingress to backend pods
spec:
  podSelector:
    matchLabels:
      app: backend
  policyTypes: [Ingress]
  ingress: []  # empty = deny all`
  },
  {
    id: 6, type: 'task',
    domain: 'Troubleshooting', domainColor: '#fee2e2', domainText: '#991b1b',
    difficulty: 'hard',
    text: 'A pod named broken-app in namespace production is stuck in CrashLoopBackOff.',
    scenario: 'Investigate the pod and identify the root cause. The pod has a single container. Write the commands you would run in sequence to diagnose and resolve the issue, and describe what you would look for.',
    answer: `# 1. Get pod status and node assignment
kubectl get pod broken-app -n production -o wide

# 2. Describe pod ‚Äî read the Events section carefully
kubectl describe pod broken-app -n production

# 3. Check current container logs
kubectl logs broken-app -n production

# 4. Check previous (crashed) container logs ‚Äî most important!
kubectl logs broken-app -n production --previous

# 5. If needed, check resource usage
kubectl top pod broken-app -n production

# Fix depending on cause:
# - Bad command/args ‚Üí edit deployment/pod spec
# - Missing ConfigMap/Secret ‚Üí create the missing resource
# - Wrong env var ‚Üí fix configmap or secret reference
# - OOMKilled ‚Üí increase memory limits`,
    explanation: 'The --previous flag is the most important flag for CrashLoopBackOff ‚Äî it shows logs from the last run before the crash. The Events section in describe often shows OOMKilled or failed probe messages. Always check both current and previous logs.',
    expCode: `kubectl logs broken-app -n production --previous
kubectl describe pod broken-app -n production`
  },
  {
    id: 7, type: 'mcq',
    domain: 'Storage', domainColor: '#ede9fe', domainText: '#6d28d9',
    difficulty: 'medium',
    text: 'A PersistentVolumeClaim is stuck in the "Pending" state. What are the most likely reasons? (select the best answer)',
    options: [
      'The pod using it was deleted',
      'No PV matches the storage class, access mode, or capacity requested by the PVC',
      'The node where the pod runs does not have enough CPU',
      'The namespace of the PV and PVC are different'
    ],
    correct: 1,
    explanation: 'PVCs bind to PVs based on storageClassName, accessModes, and capacity (PV must be >= PVC request). If no PV satisfies all constraints, the PVC stays Pending. PVs are cluster-scoped (not namespaced), so option D is incorrect. CPU is irrelevant to storage binding.',
    expCode: `kubectl describe pvc my-pvc  # look at Events for binding failures
kubectl get pv              # check available PVs and their status`
  },
  {
    id: 8, type: 'task',
    domain: 'Security', domainColor: '#dcfce7', domainText: '#166534',
    difficulty: 'medium',
    text: 'Create RBAC permissions for a CI/CD service account.',
    scenario: 'Create a ServiceAccount named deployer in the staging namespace. Create a Role named deployment-manager that allows get, list, create, update, patch, and delete on deployments. Bind this role to the deployer service account.',
    answer: `kubectl create serviceaccount deployer -n staging

kubectl create role deployment-manager \\
  --verb=get,list,create,update,patch,delete \\
  --resource=deployments \\
  -n staging

kubectl create rolebinding deployer-binding \\
  --role=deployment-manager \\
  --serviceaccount=staging:deployer \\
  -n staging

# Verify
kubectl auth can-i create deployments \\
  --as=system:serviceaccount:staging:deployer \\
  -n staging`,
    explanation: 'ServiceAccount references in --as flag use the format system:serviceaccount:namespace:name. Always verify permissions with kubectl auth can-i --as= after creating bindings. Note the Role and RoleBinding must be in the same namespace as the ServiceAccount.',
    expCode: `kubectl auth can-i create deployments \\
  --as=system:serviceaccount:staging:deployer \\
  -n staging
# Should return: yes`
  },
  {
    id: 9, type: 'mcq',
    domain: 'Architecture', domainColor: '#dbeafe', domainText: '#1d4ed8',
    difficulty: 'easy',
    text: 'Which command do you use to upgrade the kubelet and kubectl on a worker node AFTER running kubeadm upgrade node?',
    options: [
      'kubeadm upgrade apply v1.30.0',
      'apt-get install -y kubelet=1.30.0-00 kubectl=1.30.0-00 && systemctl restart kubelet',
      'kubectl set image daemonset/kubelet kubelet=v1.30.0 -n kube-system',
      'systemctl upgrade kubelet'
    ],
    correct: 1,
    explanation: 'kubeadm upgrade apply only runs on the control plane. On worker nodes, you: (1) run kubeadm upgrade node, then (2) apt-get install the new versions, then (3) systemctl daemon-reload && systemctl restart kubelet. kubelet is NOT a container/DaemonSet ‚Äî it is a systemd service.',
    expCode: `# On worker node:
kubeadm upgrade node
apt-mark unhold kubelet kubectl
apt-get install -y kubelet=1.30.0-00 kubectl=1.30.0-00
apt-mark hold kubelet kubectl
systemctl daemon-reload && systemctl restart kubelet`
  },
  {
    id: 10, type: 'task',
    domain: 'Troubleshooting', domainColor: '#fee2e2', domainText: '#991b1b',
    difficulty: 'hard',
    text: 'Node worker-01 is showing as NotReady in the cluster.',
    scenario: 'You have SSH access to worker-01. Diagnose and fix the node. The cluster uses containerd as the container runtime. Describe your diagnostic steps.',
    answer: `# Step 1: Check node conditions
kubectl describe node worker-01
# Look for: MemoryPressure, DiskPressure, NetworkUnavailable

# Step 2: SSH to the node
ssh worker-01

# Step 3: Check kubelet service
systemctl status kubelet

# Step 4: If kubelet is stopped, restart it
systemctl start kubelet

# Step 5: If kubelet is failing, check logs
journalctl -u kubelet -n 100 --no-pager
# Look for: certificate errors, config errors, CRI errors

# Step 6: If containerd is the issue
systemctl status containerd
systemctl restart containerd

# Step 7: Verify node recovers
kubectl get node worker-01  # should become Ready`,
    explanation: 'NotReady almost always means the kubelet is not running or cannot communicate with the API Server. Check in this order: kubelet service status ‚Üí journalctl logs ‚Üí containerd status. Common causes: expired certificates, bad kubelet config, disk full, containerd stopped.',
    expCode: `systemctl status kubelet
journalctl -u kubelet -n 50 --no-pager
systemctl restart kubelet`
  },
  {
    id: 11, type: 'mcq',
    domain: 'Networking', domainColor: '#fef3c7', domainText: '#92400e',
    difficulty: 'easy',
    text: 'What is the correct DNS name to reach a Service named "api-svc" in namespace "backend" from a pod in a different namespace?',
    options: [
      'api-svc',
      'api-svc.backend',
      'api-svc.backend.svc.cluster.local',
      'backend.api-svc.cluster.local'
    ],
    correct: 2,
    explanation: 'The FQDN format is: service-name.namespace.svc.cluster.local. From the same namespace, just "api-svc" works. From a different namespace, you need at minimum "api-svc.backend". The full FQDN always works regardless of namespace. Option D has the parts in the wrong order.',
    expCode: `# DNS formats (all resolve to ClusterIP)
api-svc                           # same namespace only
api-svc.backend                   # cross-namespace shorthand
api-svc.backend.svc.cluster.local # FQDN - always works`
  },
  {
    id: 12, type: 'task',
    domain: 'Networking', domainColor: '#fef3c7', domainText: '#92400e',
    difficulty: 'medium',
    text: 'Create a NetworkPolicy to isolate the database.',
    scenario: 'In namespace "production", create a NetworkPolicy that: (1) targets pods with label tier=database, (2) allows ingress only from pods with label tier=backend on port 5432, (3) blocks all egress from database pods.',
    answer: `apiVersion: networking.k8s.io/v1
kind: NetworkPolicy
metadata:
  name: database-isolation
  namespace: production
spec:
  podSelector:
    matchLabels:
      tier: database
  policyTypes:
  - Ingress
  - Egress
  ingress:
  - from:
    - podSelector:
        matchLabels:
          tier: backend
    ports:
    - protocol: TCP
      port: 5432
  egress: []`,
    explanation: 'Including Egress in policyTypes with an empty egress array blocks all outbound traffic. The ingress rule uses a combined from+ports selector ‚Äî the podSelector and ports apply together. If you put podSelector and ports as separate items in the from array, it would be an OR (not AND) condition.',
    expCode: `# Verify NetworkPolicy was created
kubectl get networkpolicy database-isolation -n production
kubectl describe networkpolicy database-isolation -n production`
  },
  {
    id: 13, type: 'mcq',
    domain: 'Workloads', domainColor: '#dcfce7', domainText: '#166534',
    difficulty: 'medium',
    text: 'A deployment has 5 replicas with a RollingUpdate strategy where maxSurge=2 and maxUnavailable=1. During an update, what is the maximum number of pods that can exist at any time?',
    options: ['5', '6', '7', '8'],
    correct: 2,
    explanation: 'maxSurge=2 means 2 extra pods above the desired count (5) can exist during the update. So maximum pods = desired + maxSurge = 5 + 2 = 7. maxUnavailable=1 means at least 4 pods must be available at all times (5 - 1 = 4 minimum running).',
    expCode: `# desired=5, maxSurge=2, maxUnavailable=1
# Max pods = 5 + 2 = 7
# Min available = 5 - 1 = 4

kubectl describe deployment myapp | grep -A3 RollingUpdate`
  },
  {
    id: 14, type: 'task',
    domain: 'Storage', domainColor: '#ede9fe', domainText: '#6d28d9',
    difficulty: 'medium',
    text: 'Configure a pod to use persistent storage.',
    scenario: 'Create a PersistentVolume named task-pv-volume with 1Gi capacity, ReadWriteOnce access mode, Retain reclaim policy, using a hostPath of /mnt/data. Then create a PVC named task-pv-claim requesting 500Mi. Finally create a pod named task-pv-pod using the nginx image that mounts the PVC at /usr/share/nginx/html.',
    answer: `# PV
apiVersion: v1
kind: PersistentVolume
metadata:
  name: task-pv-volume
spec:
  capacity:
    storage: 1Gi
  accessModes: [ReadWriteOnce]
  reclaimPolicy: Retain
  hostPath:
    path: /mnt/data
---
# PVC
apiVersion: v1
kind: PersistentVolumeClaim
metadata:
  name: task-pv-claim
spec:
  accessModes: [ReadWriteOnce]
  resources:
    requests:
      storage: 500Mi
---
# Pod
apiVersion: v1
kind: Pod
metadata:
  name: task-pv-pod
spec:
  volumes:
  - name: task-storage
    persistentVolumeClaim:
      claimName: task-pv-claim
  containers:
  - name: nginx
    image: nginx
    volumeMounts:
    - mountPath: /usr/share/nginx/html
      name: task-storage`,
    explanation: 'PVCs bind to PVs automatically when accessModes match and PV capacity >= PVC request. After creating, verify with: kubectl get pvc task-pv-claim (should show Bound status). The pod references the PVC by its claimName.',
    expCode: `kubectl get pv task-pv-volume
kubectl get pvc task-pv-claim  # should show: Bound
kubectl describe pod task-pv-pod | grep -A5 Volumes`
  },
  {
    id: 15, type: 'mcq',
    domain: 'Troubleshooting', domainColor: '#fee2e2', domainText: '#991b1b',
    difficulty: 'easy',
    text: 'A pod is in "Pending" state. kubectl describe shows: "0/3 nodes are available: 3 Insufficient cpu." What is the correct fix?',
    options: [
      'Delete and recreate the pod',
      'Reduce the cpu request in the pod spec or add more nodes',
      'Increase the cluster version',
      'Change the pod restart policy to Always'
    ],
    correct: 1,
    explanation: 'Pending with "Insufficient cpu" means no node has enough unreserved CPU to satisfy the pod\'s requests. Solutions: (1) reduce requests in pod spec, (2) add worker nodes, (3) check if other pods on nodes can be scaled down. CPU limits are irrelevant here ‚Äî only requests affect scheduling.',
    expCode: `kubectl describe pod mypod | grep -A5 Events
# "Insufficient cpu" ‚Üí reduce requests or add nodes

kubectl describe nodes | grep -A5 "Allocated resources"`
  },
  {
    id: 16, type: 'task',
    domain: 'Architecture', domainColor: '#dbeafe', domainText: '#1d4ed8',
    difficulty: 'hard',
    text: 'Upgrade the Kubernetes cluster from v1.29 to v1.30.',
    scenario: 'You have a cluster with one control-plane node and one worker node. Both are running Ubuntu with apt package manager. Describe the complete step-by-step upgrade process in the correct order.',
    answer: `# === CONTROL PLANE ===

# 1. Upgrade kubeadm
apt-mark unhold kubeadm
apt-get update && apt-get install -y kubeadm=1.30.0-00
apt-mark hold kubeadm

# 2. Plan and verify
kubeadm upgrade plan

# 3. Apply upgrade
kubeadm upgrade apply v1.30.0

# 4. Drain control plane
kubectl drain controlplane --ignore-daemonsets

# 5. Upgrade kubelet and kubectl
apt-mark unhold kubelet kubectl
apt-get install -y kubelet=1.30.0-00 kubectl=1.30.0-00
apt-mark hold kubelet kubectl
systemctl daemon-reload && systemctl restart kubelet

# 6. Uncordon
kubectl uncordon controlplane

# === WORKER NODE ===

# 7. SSH to worker, upgrade kubeadm
ssh worker-01
apt-mark unhold kubeadm
apt-get install -y kubeadm=1.30.0-00
apt-mark hold kubeadm

# 8. Upgrade node config
kubeadm upgrade node

# 9. Back on control plane - drain worker
kubectl drain worker-01 --ignore-daemonsets --delete-emptydir-data

# 10. On worker - upgrade kubelet
apt-get install -y kubelet=1.30.0-00 kubectl=1.30.0-00
systemctl daemon-reload && systemctl restart kubelet

# 11. Uncordon worker
kubectl uncordon worker-01

# 12. Verify
kubectl get nodes`,
    explanation: 'Key rules: (1) Always upgrade control-plane first. (2) Use kubeadm upgrade apply on control-plane, kubeadm upgrade node on workers. (3) kubelet/kubectl are upgraded separately with apt. (4) Always drain before upgrading a node\'s kubelet. (5) Only one minor version at a time.',
    expCode: `kubectl get nodes  # all should show v1.30.x
# NAME           STATUS   ROLES    AGE   VERSION
# controlplane   Ready    master   1d    v1.30.0
# worker-01      Ready    <none>   1d    v1.30.0`
  },
  {
    id: 17, type: 'mcq',
    domain: 'Security', domainColor: '#dcfce7', domainText: '#166534',
    difficulty: 'medium',
    text: 'What is the difference between a Role and a ClusterRole?',
    options: [
      'Role allows more permissions than ClusterRole',
      'Role is namespace-scoped; ClusterRole is cluster-wide and can also grant access to non-namespaced resources',
      'ClusterRole can only be used with ClusterRoleBinding',
      'Role applies to all namespaces; ClusterRole applies to only one'
    ],
    correct: 1,
    explanation: 'Role is namespace-scoped (permissions only within that namespace). ClusterRole is cluster-wide AND can grant access to non-namespaced resources (nodes, PVs, namespaces). A ClusterRole can be bound using EITHER a ClusterRoleBinding (cluster-wide) OR a RoleBinding (restricts to a specific namespace ‚Äî useful for reusing common role definitions).',
    expCode: `# ClusterRole can be bound in a specific namespace with RoleBinding:
kubectl create rolebinding view-in-prod \\
  --clusterrole=view \\
  --user=jane \\
  --namespace=production`
  },
  {
    id: 18, type: 'task',
    domain: 'Workloads', domainColor: '#dcfce7', domainText: '#166534',
    difficulty: 'medium',
    text: 'Create a CronJob that runs a database backup every day at midnight.',
    scenario: 'Create a CronJob named db-backup in the default namespace. It should use the image postgres:14 and run the command /bin/backup.sh. Set concurrencyPolicy to Forbid (so it skips if the previous job is still running). Keep the last 3 successful jobs and 1 failed job.',
    answer: `apiVersion: batch/v1
kind: CronJob
metadata:
  name: db-backup
  namespace: default
spec:
  schedule: "0 0 * * *"
  concurrencyPolicy: Forbid
  successfulJobsHistoryLimit: 3
  failedJobsHistoryLimit: 1
  jobTemplate:
    spec:
      template:
        spec:
          restartPolicy: OnFailure
          containers:
          - name: backup
            image: postgres:14
            command: ["/bin/backup.sh"]`,
    explanation: 'CronJob schedule uses standard cron syntax: "0 0 * * *" = midnight daily. concurrencyPolicy: Forbid prevents overlapping runs. restartPolicy must be OnFailure or Never for Jobs (not Always). successfulJobsHistoryLimit controls how many completed pods to keep for debugging.',
    expCode: `kubectl get cronjob db-backup
kubectl get jobs  # shows triggered jobs
# Manually trigger for testing:
kubectl create job --from=cronjob/db-backup manual-test`
  },
  {
    id: 19, type: 'mcq',
    domain: 'Networking', domainColor: '#fef3c7', domainText: '#92400e',
    difficulty: 'hard',
    text: 'You create a Service of type ClusterIP but kubectl get endpoints shows "<none>". What is the most likely cause?',
    options: [
      'The service port is incorrect',
      'The service selector labels do not match the labels on the pods',
      'The pods are in a different cluster',
      'kube-proxy is not running on the node'
    ],
    correct: 1,
    explanation: 'Endpoints are populated by the Endpoints Controller by matching the Service\'s spec.selector against pod labels. If no pods have all the matching labels, the endpoints list is empty. kube-proxy reads endpoints ‚Äî it doesn\'t create them. Always verify: kubectl get pods --show-labels and compare with kubectl describe service.',
    expCode: `kubectl describe service my-service  # check Selector
kubectl get pods --show-labels       # check pod labels match

# Example mismatch:
# Service selector: app=backend
# Pod label: app=backend-v2  ‚Üê doesn't match!`
  },
  {
    id: 20, type: 'task',
    domain: 'Troubleshooting', domainColor: '#fee2e2', domainText: '#991b1b',
    difficulty: 'hard',
    text: 'The kube-scheduler is not scheduling new pods.',
    scenario: 'New pods remain in Pending state with no node assignment. The kube-scheduler pod in kube-system is in Error/CrashLoopBackOff. Diagnose and fix the scheduler.',
    answer: `# Step 1: Check scheduler pod
kubectl get pods -n kube-system | grep scheduler
kubectl describe pod kube-scheduler-controlplane -n kube-system

# Step 2: Check scheduler logs
kubectl logs kube-scheduler-controlplane -n kube-system
kubectl logs kube-scheduler-controlplane -n kube-system --previous

# Step 3: The scheduler is a static pod - check the manifest
cat /etc/kubernetes/manifests/kube-scheduler.yaml

# Step 4: Look for common issues:
# - Wrong --kubeconfig path
# - Wrong --config path
# - Typo in flags or image name
# - Volume mount pointing to wrong path

# Step 5: Fix the manifest (kubelet auto-restarts)
vi /etc/kubernetes/manifests/kube-scheduler.yaml

# Step 6: Verify scheduler recovers
kubectl get pods -n kube-system | grep scheduler
# Then verify a pending pod gets scheduled:
kubectl get pods  # should no longer be stuck in Pending`,
    explanation: 'Control plane components (apiserver, scheduler, controller-manager, etcd) all run as static pods. Kubelet monitors /etc/kubernetes/manifests/ and restarts them on any change. Common scheduler issues: wrong kubeconfig path, corrupted config file, wrong image tag. Check both current and --previous logs.',
    expCode: `vi /etc/kubernetes/manifests/kube-scheduler.yaml
# After saving, kubelet auto-recreates the pod
kubectl get pods -n kube-system -w  # watch recovery`
  }
];

let currentQ = 0;
let answers = {};
let skipped = new Set();
let answered = new Set();
let timerInterval = null;
let secondsLeft = 7200;
let hintShown = false;

function startMock() {
  currentQ = 0;
  answers = {};
  skipped = new Set();
  answered = new Set();
  secondsLeft = 7200;
  hintShown = false;

  document.getElementById('resultsScreen').classList.remove('show');
  document.getElementById('questionScreen').style.display = '';
  document.getElementById('mockOverlay').classList.add('active');
  document.body.style.overflow = 'hidden';

  renderQuestion();
  startTimer();
}

function closeMock() {
  document.getElementById('mockOverlay').classList.remove('active');
  document.body.style.overflow = '';
  clearInterval(timerInterval);
}

function startTimer() {
  clearInterval(timerInterval);
  timerInterval = setInterval(() => {
    secondsLeft--;
    if (secondsLeft <= 0) {
      clearInterval(timerInterval);
      showResults();
      return;
    }
    const m = Math.floor(secondsLeft / 60).toString().padStart(2,'0');
    const s = (secondsLeft % 60).toString().padStart(2,'0');
    document.getElementById('timerVal').textContent = m + ':' + s;
    if (secondsLeft <= 300) {
      document.getElementById('timerVal').style.color = '#fca5a5';
    }
  }, 1000);
}

function renderQuestion() {
  const q = QUESTIONS[currentQ];
  hintShown = false;

  // Update progress
  const pct = ((currentQ + 1) / QUESTIONS.length * 100).toFixed(0);
  document.getElementById('mockProgFill').style.width = pct + '%';
  document.getElementById('mockSubtitle').textContent = `Question ${currentQ+1} of ${QUESTIONS.length} ¬∑ ${QUESTIONS.length} questions`;

  // Render dots
  const dotsEl = document.getElementById('qDots');
  dotsEl.innerHTML = QUESTIONS.map((_, i) => {
    let cls = 'q-dot';
    if (i === currentQ) cls += ' current';
    else if (answered.has(i)) cls += ' answered';
    else if (skipped.has(i)) cls += ' skipped';
    return `<div class="${cls}" onclick="goToQ(${i})"></div>`;
  }).join('');

  // Build question HTML
  let bodyHtml = `
    <div class="q-meta">
      <span class="q-num">Q${currentQ+1} / ${QUESTIONS.length}</span>
      <span class="q-domain" style="background:${q.domainColor};color:${q.domainText};border:1px solid ${q.domainText}33;font-size:11px;font-weight:700;padding:3px 10px;border-radius:20px">${q.domain}</span>
      <span class="q-diff diff-${q.difficulty}">${q.difficulty.charAt(0).toUpperCase()+q.difficulty.slice(1)}</span>
    </div>
    <div class="q-text">${q.text}</div>
  `;

  if (q.scenario) {
    bodyHtml += `<div class="q-scenario">${q.scenario}</div>`;
  }

  if (q.type === 'mcq') {
    bodyHtml += `<div class="mcq-options" id="mcqOptions">`;
    q.options.forEach((opt, i) => {
      const letter = String.fromCharCode(65 + i);
      bodyHtml += `<div class="mcq-option" onclick="selectMcq(${i})" id="opt-${i}">
        <div class="mcq-letter">${letter}</div>
        <div class="mcq-text">${opt}</div>
      </div>`;
    });
    bodyHtml += `</div>`;
  } else {
    bodyHtml += `
      <div class="answer-area">
        <textarea id="taskAnswer" placeholder="Write your kubectl commands or YAML here...&#10;&#10;There are no syntax checks ‚Äî this is for self-assessment. After submitting, compare with the model answer.">${answers[currentQ] || ''}</textarea>
        <div class="answer-toolbar">
          <span>üí° Write the commands you would run, or the YAML you would apply</span>
        </div>
      </div>
    `;
  }

  bodyHtml += `<div class="explanation" id="explanation"></div>`;
  document.getElementById('mockBody').innerHTML = bodyHtml;

  // Show/hide buttons
  const alreadyAnswered = answered.has(currentQ);
  document.getElementById('submitBtn').style.display = alreadyAnswered ? 'none' : '';
  document.getElementById('nextBtn').style.display = alreadyAnswered ? '' : 'none';
  document.getElementById('hintBtn').style.display = q.type === 'task' || alreadyAnswered ? 'none' : '';

  if (alreadyAnswered) {
    showExplanation(q, answers[currentQ]);
  }
}

function selectMcq(idx) {
  if (answered.has(currentQ)) return;
  document.querySelectorAll('.mcq-option').forEach((o, i) => {
    o.classList.toggle('selected', i === idx);
  });
  answers[currentQ] = idx;
}

function showHint() {
  const q = QUESTIONS[currentQ];
  if (hintShown) return;
  hintShown = true;
  const expEl = document.getElementById('explanation');
  expEl.innerHTML = `<div class="exp-title">üí° Hint</div>${q.explanation.split('.')[0] + '.'}`;
  expEl.classList.add('show');
  document.getElementById('hintBtn').style.display = 'none';
}

function submitAnswer() {
  const q = QUESTIONS[currentQ];
  if (q.type === 'task') {
    const val = document.getElementById('taskAnswer')?.value || '';
    answers[currentQ] = val;
    answered.add(currentQ);
    showExplanation(q, val);
  } else {
    if (answers[currentQ] === undefined) return;
    answered.add(currentQ);
    showExplanation(q, answers[currentQ]);
  }
  document.getElementById('submitBtn').style.display = 'none';
  document.getElementById('nextBtn').style.display = '';
  document.getElementById('hintBtn').style.display = 'none';
  renderDots();
}

function showExplanation(q, userAnswer) {
  const expEl = document.getElementById('explanation');
  let isCorrect = false;

  if (q.type === 'mcq') {
    isCorrect = userAnswer === q.correct;
    // Style options
    document.querySelectorAll('.mcq-option').forEach((el, i) => {
      el.style.pointerEvents = 'none';
      if (i === q.correct) el.classList.add('correct');
      else if (i === userAnswer && userAnswer !== q.correct) el.classList.add('wrong');
    });
  } else {
    isCorrect = userAnswer.trim().length > 20;
  }

  let expHtml = `
    <div class="exp-title">${q.type === 'mcq' ? (isCorrect ? '‚úÖ Correct!' : '‚ùå Incorrect') : 'üìã Model Answer'}</div>
    <div>${q.explanation}</div>
  `;
  if (q.expCode) {
    expHtml += `<div class="exp-code">${escapeHtml(q.expCode)}</div>`;
  }
  if (q.type === 'task' && q.answer) {
    expHtml += `<div style="margin-top:10px;font-weight:700;font-size:11px;letter-spacing:.08em;margin-bottom:4px">COMPLETE ANSWER</div><div class="exp-code">${escapeHtml(q.answer)}</div>`;
  }

  expEl.innerHTML = expHtml;
  expEl.style.background = q.type === 'mcq' && !isCorrect ? '#fef2f2' : '#fffbeb';
  expEl.style.borderColor = q.type === 'mcq' && !isCorrect ? '#fecaca' : '#fde68a';
  expEl.style.color = q.type === 'mcq' && !isCorrect ? '#991b1b' : '#78350f';
  expEl.classList.add('show');
}

function escapeHtml(str) {
  return str.replace(/&/g,'&amp;').replace(/</g,'&lt;').replace(/>/g,'&gt;');
}

function skipQuestion() {
  if (!answered.has(currentQ)) skipped.add(currentQ);
  goToNextUnanswered();
}

function nextQuestion() {
  goToNextUnanswered();
}

function goToNextUnanswered() {
  let next = currentQ + 1;
  if (next >= QUESTIONS.length) {
    // Check if all answered
    const totalAnswered = answered.size + skipped.size;
    if (totalAnswered >= QUESTIONS.length) {
      showResults();
      return;
    }
    next = 0;
  }
  currentQ = next;
  renderQuestion();
}

function goToQ(idx) {
  currentQ = idx;
  renderQuestion();
}

function renderDots() {
  const dotsEl = document.getElementById('qDots');
  dotsEl.innerHTML = QUESTIONS.map((_, i) => {
    let cls = 'q-dot';
    if (i === currentQ) cls += ' current';
    else if (answered.has(i)) cls += ' answered';
    else if (skipped.has(i)) cls += ' skipped';
    return `<div class="${cls}" onclick="goToQ(${i})"></div>`;
  }).join('');
}

function showResults() {
  clearInterval(timerInterval);
  let correct = 0;
  QUESTIONS.forEach((q, i) => {
    if (q.type === 'mcq' && answered.has(i) && answers[i] === q.correct) correct++;
    else if (q.type === 'task' && answered.has(i)) correct++;
  });
  const wrong = answered.size - correct;
  const skip = QUESTIONS.length - answered.size;
  const pct = Math.round((correct / QUESTIONS.length) * 100);
  const pass = pct >= 66;

  document.getElementById('questionScreen').style.display = 'none';
  const rs = document.getElementById('resultsScreen');
  rs.classList.add('show');

  document.getElementById('resultsRing').className = 'results-ring ' + (pass ? 'ring-pass' : 'ring-fail');
  document.getElementById('resultsRing').innerHTML = `<div>${pct}%</div><div style="font-size:14px;font-weight:600;margin-top:4px">${pass ? 'PASS' : 'FAIL'}</div>`;
  document.getElementById('resultsTitle').textContent = pass ? 'üéâ You Passed!' : 'üìö Keep Studying';
  document.getElementById('resultsDesc').textContent = pass
    ? `${correct} of ${QUESTIONS.length} correct ‚Äî ${pct}% (pass threshold: 66%). You're on track for the real exam!`
    : `${correct} of ${QUESTIONS.length} correct ‚Äî ${pct}% (need 66% to pass). Review the explanations and try again.`;

  document.getElementById('rb-correct').textContent = correct;
  document.getElementById('rb-wrong').textContent = wrong;
  document.getElementById('rb-skip').textContent = skip;
}
</script>
</body>
</html>
